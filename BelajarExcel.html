<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Belajar Excel Lengkap</title>
    
    <!-- React & ReactDOM -->
    <script crossorigin src="https://unpkg.com/react@18/umd/react.development.js"></script>
    <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.development.js"></script>
    
    <!-- Babel untuk JSX -->
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    
    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    <script>
        tailwind.config = {
            darkMode: 'class',
            theme: {
                extend: {
                    fontFamily: {
                        inter: ['Inter', 'sans-serif'],
                    },
                },
            },
        }
    </script>

    <!-- Font Inter -->
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;800&display=swap" rel="stylesheet">
    
    <style>
        body { font-family: 'Inter', sans-serif; }
        /* Custom Scrollbar untuk tampilan lebih rapi */
        ::-webkit-scrollbar { width: 8px; height: 8px; }
        ::-webkit-scrollbar-track { background: transparent; }
        ::-webkit-scrollbar-thumb { background-color: #cbd5e1; border-radius: 4px; }
        .dark ::-webkit-scrollbar-thumb { background-color: #475569; }
        ::-webkit-scrollbar-thumb:hover { background-color: #94a3b8; }
    </style>
</head>
<body class="bg-gray-50 dark:bg-gray-900 text-gray-900 dark:text-white transition-colors duration-200">
    <div id="root"></div>

    <script type="text/babel">
        const { useState, useEffect, useMemo, useCallback } = React;

        // --- Helper: Warna Kategori Dinamis ---
        const getCategoryColor = (category) => {
            const colors = {
                'Matematika': 'bg-blue-100 text-blue-800 dark:bg-blue-900/50 dark:text-blue-200 border-blue-200 dark:border-blue-800',
                'Logika': 'bg-purple-100 text-purple-800 dark:bg-purple-900/50 dark:text-purple-200 border-purple-200 dark:border-purple-800',
                'Pencarian': 'bg-amber-100 text-amber-800 dark:bg-amber-900/50 dark:text-amber-200 border-amber-200 dark:border-amber-800',
                'Statistik': 'bg-cyan-100 text-cyan-800 dark:bg-cyan-900/50 dark:text-cyan-200 border-cyan-200 dark:border-cyan-800',
                'Teks': 'bg-pink-100 text-pink-800 dark:bg-pink-900/50 dark:text-pink-200 border-pink-200 dark:border-pink-800',
                'Tanggal & Waktu': 'bg-teal-100 text-teal-800 dark:bg-teal-900/50 dark:text-teal-200 border-teal-200 dark:border-teal-800',
                'Informasi': 'bg-gray-200 text-gray-800 dark:bg-gray-700/50 dark:text-gray-200 border-gray-300 dark:border-gray-600',
                'Finansial': 'bg-emerald-100 text-emerald-800 dark:bg-emerald-900/50 dark:text-emerald-200 border-emerald-200 dark:border-emerald-800',
                'Navigasi': 'bg-indigo-100 text-indigo-800 dark:bg-indigo-900/50 dark:text-indigo-200 border-indigo-200 dark:border-indigo-800',
                'Seleksi': 'bg-sky-100 text-sky-800 dark:bg-sky-900/50 dark:text-sky-200 border-sky-200 dark:border-sky-800',
                'Seleksi Lanjutan': 'bg-sky-100 text-sky-800 dark:bg-sky-900/50 dark:text-sky-200 border-sky-200 dark:border-sky-800',
                'Edit': 'bg-orange-100 text-orange-800 dark:bg-orange-900/50 dark:text-orange-200 border-orange-200 dark:border-orange-800',
                'Format': 'bg-fuchsia-100 text-fuchsia-800 dark:bg-fuchsia-900/50 dark:text-fuchsia-200 border-fuchsia-200 dark:border-fuchsia-800',
                'Data': 'bg-lime-100 text-lime-800 dark:bg-lime-900/50 dark:text-lime-200 border-lime-200 dark:border-lime-800',
                'Fungsi & Kalkulasi': 'bg-violet-100 text-violet-800 dark:bg-violet-900/50 dark:text-violet-200 border-violet-200 dark:border-violet-800',
                'Workbook': 'bg-slate-100 text-slate-800 dark:bg-slate-700/50 dark:text-slate-200 border-slate-200 dark:border-slate-600',
                'PivotTable': 'bg-rose-100 text-rose-800 dark:bg-rose-900/50 dark:text-rose-200 border-rose-200 dark:border-rose-800',
                'Dialog Boxes': 'bg-neutral-100 text-neutral-800 dark:bg-neutral-700/50 dark:text-neutral-200 border-neutral-200 dark:border-neutral-600',
                'Lain-lain': 'bg-stone-100 text-stone-800 dark:bg-stone-700/50 dark:text-stone-200 border-stone-200 dark:border-stone-600',
                'Developer': 'bg-red-100 text-red-800 dark:bg-red-900/50 dark:text-red-200 border-red-200 dark:border-red-800',
            };
            return colors[category] || 'bg-gray-100 text-gray-800 dark:bg-gray-800 dark:text-gray-200 border-gray-200';
        };

        const getCategoryButtonClass = (category, isSelected) => {
            const baseClass = "px-3 py-1 text-sm font-medium rounded-full transition-all duration-200 border";
            if (!isSelected) {
                return `${baseClass} bg-white dark:bg-gray-800 text-gray-600 dark:text-gray-300 border-gray-200 dark:border-gray-700 hover:bg-gray-50 dark:hover:bg-gray-700`;
            }
            const activeColors = {
                'Matematika': 'bg-blue-600 border-blue-600 text-white',
                'Logika': 'bg-purple-600 border-purple-600 text-white',
                'Pencarian': 'bg-amber-600 border-amber-600 text-white',
                'Statistik': 'bg-cyan-600 border-cyan-600 text-white',
                'Teks': 'bg-pink-600 border-pink-600 text-white',
                'Tanggal & Waktu': 'bg-teal-600 border-teal-600 text-white',
                'Informasi': 'bg-gray-600 border-gray-600 text-white',
                'Finansial': 'bg-emerald-600 border-emerald-600 text-white',
                'Navigasi': 'bg-indigo-600 border-indigo-600 text-white',
                'Seleksi': 'bg-sky-600 border-sky-600 text-white',
                'Edit': 'bg-orange-600 border-orange-600 text-white',
                'Format': 'bg-fuchsia-600 border-fuchsia-600 text-white',
                'Data': 'bg-lime-600 border-lime-600 text-white',
                'Fungsi & Kalkulasi': 'bg-violet-600 border-violet-600 text-white',
                'Workbook': 'bg-slate-600 border-slate-600 text-white',
                'PivotTable': 'bg-rose-600 border-rose-600 text-white',
                'Semua': 'bg-gray-800 dark:bg-white text-white dark:text-gray-900 border-transparent',
                'Seleksi Lanjutan': 'bg-sky-600 border-sky-600 text-white',
                'Dialog Boxes': 'bg-neutral-600 border-neutral-600 text-white',
                'Lain-lain': 'bg-stone-600 border-stone-600 text-white',
                'Developer': 'bg-red-600 border-red-600 text-white'
            };
            // Menggunakan baseClass + activeColor + efek shadow/transform
            const colorClass = activeColors[category] || 'bg-blue-600 border-blue-600 text-white';
            return `${baseClass} ${colorClass} shadow-md transform scale-105`;
        };

        // --- (MULAI) Database Rumus Excel (LENGKAP: 136 Rumus) ---
        const formulaData = [
          { id: 'f1', name: 'SUM', category: 'Matematika', description: 'Menjumlahkan sekumpulan nilai atau rentang sel.', syntax: 'SUM(number1, [number2], ...)', example: '`=SUM(A1:A10)` menjumlahkan A1-A10.\n`=SUM(A1, 10)` menjumlahkan A1 dan 10.' },
          { id: 'f2', name: 'IF', category: 'Logika', description: 'Uji logika: satu nilai jika BENAR, nilai lain jika SALAH.', syntax: 'IF(logical_test, value_if_true, [value_if_false])', example: '`=IF(A1>70, "Lulus", "Gagal")`' },
          { id: 'f3', name: 'VLOOKUP', category: 'Pencarian', description: 'Mencari data di kolom pertama tabel, ambil data di kolom kanan.', syntax: 'VLOOKUP(lookup_value, table_array, col_index_num, [range_lookup])', example: '`=VLOOKUP("ID01", A:C, 2, FALSE)`' },
          { id: 'f4', name: 'INDEX', category: 'Pencarian', description: 'Ambil nilai dari persimpangan baris & kolom tertentu.', syntax: 'INDEX(array, row_num, [column_num])', example: '`=INDEX(A1:C5, 2, 3)` ambil baris 2 kolom 3.' },
          { id: 'f5', name: 'MATCH', category: 'Pencarian', description: 'Cari posisi (urutan) item dalam rentang.', syntax: 'MATCH(lookup_value, lookup_array, [match_type])', example: '`=MATCH("Apel", A1:A10, 0)`' },
          { id: 'f6', name: 'XLOOKUP', category: 'Pencarian', description: 'Versi modern VLOOKUP. Lebih fleksibel, bisa ke kiri.', syntax: 'XLOOKUP(lookup_value, lookup_array, return_array, ...)', example: '`=XLOOKUP(F1, A:A, B:B)`' },
          { id: 'f7', name: 'FILTER', category: 'Pencarian', description: 'Filter data berdasarkan kriteria (Dynamic Array).', syntax: 'FILTER(array, include, [if_empty])', example: '`=FILTER(A:C, B:B="Lulus")`' },
          { id: 'f8', name: 'COUNTIF', category: 'Statistik', description: 'Hitung jumlah sel yang memenuhi 1 kriteria.', syntax: 'COUNTIF(range, criteria)', example: '`=COUNTIF(A1:A10, ">50")`' },
          { id: 'f9', name: 'AVERAGE', category: 'Statistik', description: 'Hitung nilai rata-rata.', syntax: 'AVERAGE(number1, ...)', example: '`=AVERAGE(A1:A10)`' },
          { id: 'f10', name: 'MAX', category: 'Statistik', description: 'Cari nilai tertinggi.', syntax: 'MAX(number1, ...)', example: '`=MAX(A1:A10)`' },
          { id: 'f11', name: 'MIN', category: 'Statistik', description: 'Cari nilai terendah.', syntax: 'MIN(number1, ...)', example: '`=MIN(A1:A10)`' },
          { id: 'f12', name: 'COUNT', category: 'Statistik', description: 'Hitung sel berisi ANGKA saja.', syntax: 'COUNT(value1, ...)', example: '`=COUNT(A1:A10)`' },
          { id: 'f13', name: 'COUNTA', category: 'Statistik', description: 'Hitung sel TIDAK KOSONG (angka/teks).', syntax: 'COUNTA(value1, ...)', example: '`=COUNTA(A1:A10)`' },
          { id: 'f14', name: 'LARGE', category: 'Statistik', description: 'Cari nilai tertinggi ke-k.', syntax: 'LARGE(array, k)', example: '`=LARGE(A1:A10, 2)` (Juara 2)' },
          { id: 'f15', name: 'SMALL', category: 'Statistik', description: 'Cari nilai terendah ke-k.', syntax: 'SMALL(array, k)', example: '`=SMALL(A1:A10, 3)` (Terendah ke-3)' },
          { id: 'f16', name: 'SUMPRODUCT', category: 'Matematika', description: 'Kalikan lalu jumlahkan array.', syntax: 'SUMPRODUCT(array1, [array2], ...)', example: '`=SUMPRODUCT(A1:A5, B1:B5)` (A1*B1 + ...)' },
          { id: 'f17', name: 'AGGREGATE', category: 'Matematika', description: 'Kalkulasi yang bisa abaikan error/hidden rows.', syntax: 'AGGREGATE(func_num, options, array, ...)', example: '`=AGGREGATE(9, 6, A1:A10)` SUM abaikan error.' },
          { id: 'f18', name: 'OFFSET', category: 'Pencarian', description: 'Geser referensi sel.', syntax: 'OFFSET(reference, rows, cols, ...)', example: '`=OFFSET(A1, 1, 2)` geser ke B2.' },
          { id: 'f19', name: 'TEXTJOIN', category: 'Teks', description: 'Gabung teks dengan pemisah.', syntax: 'TEXTJOIN(delimiter, ignore_empty, text1, ...)', example: '`=TEXTJOIN(", ", TRUE, A1:A3)`' },
          { id: 'f20', name: 'ROUND', category: 'Matematika', description: 'Bulatkan angka (matematis).', syntax: 'ROUND(number, digits)', example: '`=ROUND(3.56, 1)` -> 3.6' },
          { id: 'f21', name: 'ROUNDDOWN', category: 'Matematika', description: 'Bulatkan ke bawah.', syntax: 'ROUNDDOWN(number, digits)', example: '`=ROUNDDOWN(3.9, 0)` -> 3' },
          { id: 'f22', name: 'ROUNDUP', category: 'Matematika', description: 'Bulatkan ke atas.', syntax: 'ROUNDUP(number, digits)', example: '`=ROUNDUP(3.1, 0)` -> 4' },
          { id: 'f23', name: 'INT', category: 'Matematika', description: 'Ambil bilangan bulat (selalu ke bawah).', syntax: 'INT(number)', example: '`=INT(3.9)` -> 3' },
          { id: 'f24', name: 'CEILING', category: 'Matematika', description: 'Bulatkan ke atas ke kelipatan terdekat.', syntax: 'CEILING(number, significance)', example: '`=CEILING(22, 5)` -> 25' },
          { id: 'f25', name: 'FLOOR', category: 'Matematika', description: 'Bulatkan ke bawah ke kelipatan terdekat.', syntax: 'FLOOR(number, significance)', example: '`=FLOOR(22, 5)` -> 20' },
          { id: 'f26', name: 'MROUND', category: 'Matematika', description: 'Bulatkan ke kelipatan terdekat (bisa atas/bawah).', syntax: 'MROUND(number, multiple)', example: '`=MROUND(22, 5)` -> 20' },
          { id: 'f27', name: 'CONCATENATE', category: 'Teks', description: 'Gabung teks (jadul).', syntax: 'CONCATENATE(text1, ...)', example: '`=CONCATENATE("A", "B")`' },
          { id: 'f28', name: '& (Ampersand)', category: 'Teks', description: 'Operator gabung teks.', syntax: 'text1 & text2', example: '`="Halo" & " " & "Dunia"`' },
          { id: 'f29', name: 'TRIM', category: 'Teks', description: 'Hapus spasi berlebih.', syntax: 'TRIM(text)', example: '`=TRIM("  Halo   ")` -> "Halo"' },
          { id: 'f30', name: 'CLEAN', category: 'Teks', description: 'Hapus karakter non-cetak.', syntax: 'CLEAN(text)', example: 'Hapus enter/tab aneh.' },
          { id: 'f31', name: 'UPPER', category: 'Teks', description: 'Jadikan HURUF BESAR.', syntax: 'UPPER(text)', example: '`=UPPER("Halo")` -> "HALO"' },
          { id: 'f32', name: 'LOWER', category: 'Teks', description: 'Jadikan huruf kecil.', syntax: 'LOWER(text)', example: '`=LOWER("Halo")` -> "halo"' },
          { id: 'f33', name: 'PROPER', category: 'Teks', description: 'Huruf Besar Awal Kata.', syntax: 'PROPER(text)', example: '`=PROPER("halo dunia")` -> "Halo Dunia"' },
          { id: 'f34', name: 'LEFT', category: 'Teks', description: 'Ambil karakter dari kiri.', syntax: 'LEFT(text, [chars])', example: '`=LEFT("Excel", 2)` -> "Ex"' },
          { id: 'f35', name: 'MID', category: 'Teks', description: 'Ambil karakter dari tengah.', syntax: 'MID(text, start, chars)', example: '`=MID("Excel", 2, 2)` -> "xc"' },
          { id: 'f36', name: 'RIGHT', category: 'Teks', description: 'Ambil karakter dari kanan.', syntax: 'RIGHT(text, [chars])', example: '`=RIGHT("Excel", 2)` -> "el"' },
          { id: 'f37', name: 'LEN', category: 'Teks', description: 'Hitung jumlah karakter.', syntax: 'LEN(text)', example: '`=LEN("Excel")` -> 5' },
          { id: 'f38', name: 'HLOOKUP', category: 'Pencarian', description: 'Cari mendatar (baris pertama).', syntax: 'HLOOKUP(val, table, row_idx, ...)', example: '`=HLOOKUP("Bln", A1:E5, 2, 0)`' },
          { id: 'f39', name: 'INDEX-MATCH', category: 'Pencarian', description: 'Kombinasi sakti pengganti VLOOKUP.', syntax: 'INDEX(col_result, MATCH(val, col_search, 0))', example: 'Lebih fleksibel dari VLOOKUP.' },
          { id: 'f40', name: 'SUMIF', category: 'Statistik', description: 'Jumlahkan dengan 1 syarat.', syntax: 'SUMIF(range, criteria, [sum_range])', example: '`=SUMIF(A:A, ">10", B:B)`' },
          { id: 'f41', name: 'SUMIFS', category: 'Statistik', description: 'Jumlahkan dengan BANYAK syarat.', syntax: 'SUMIFS(sum_range, criteria_range1, criteria1, ...)', example: '`=SUMIFS(C:C, A:A, "Produk A", B:B, "Jan")`' },
          { id: 'f42', name: 'AVERAGEIF', category: 'Statistik', description: 'Rata-rata dengan 1 syarat.', syntax: 'AVERAGEIF(range, criteria, [avg_range])', example: '`=AVERAGEIF(A:A, "Lulus", B:B)`' },
          { id: 'f43', name: 'AVERAGEIFS', category: 'Statistik', description: 'Rata-rata dengan BANYAK syarat.', syntax: 'AVERAGEIFS(avg_range, range1, crit1, ...)', example: '`=AVERAGEIFS(C:C, A:A, "Pria", B:B, ">20")`' },
          { id: 'f44', name: 'COUNTIFS', category: 'Statistik', description: 'Hitung jumlah data dengan BANYAK syarat.', syntax: 'COUNTIFS(range1, crit1, range2, crit2...)', example: '`=COUNTIFS(A:A, "Lulus", B:B, ">80")`' },
          { id: 'f45', name: 'MAXIFS', category: 'Statistik', description: 'Nilai Max dengan syarat.', syntax: 'MAXIFS(max_range, range1, crit1...)', example: '`=MAXIFS(Sales, Region, "West")`' },
          { id: 'f46', name: 'MINIFS', category: 'Statistik', description: 'Nilai Min dengan syarat.', syntax: 'MINIFS(min_range, range1, crit1...)', example: '`=MINIFS(Sales, Region, "West")`' },
          { id: 'f47', name: 'NOW', category: 'Tanggal & Waktu', description: 'Tanggal & Waktu sekarang (update terus).', syntax: 'NOW()', example: '`=NOW()` -> 25/12/2023 14:30' },
          { id: 'f48', name: 'TODAY', category: 'Tanggal & Waktu', description: 'Tanggal hari ini saja.', syntax: 'TODAY()', example: '`=TODAY()` -> 25/12/2023' },
          { id: 'f49', name: 'DAY', category: 'Tanggal & Waktu', description: 'Ambil angka TANGGAL (1-31).', syntax: 'DAY(date)', example: '`=DAY(A1)`' },
          { id: 'f50', name: 'MONTH', category: 'Tanggal & Waktu', description: 'Ambil angka BULAN (1-12).', syntax: 'MONTH(date)', example: '`=MONTH(A1)`' },
          { id: 'f51', name: 'YEAR', category: 'Tanggal & Waktu', description: 'Ambil angka TAHUN.', syntax: 'YEAR(date)', example: '`=YEAR(A1)`' },
          { id: 'f52', name: 'DATE', category: 'Tanggal & Waktu', description: 'Buat tanggal dari angka thn, bln, tgl.', syntax: 'DATE(year, month, day)', example: '`=DATE(2023, 12, 25)`' },
          { id: 'f53', name: 'HOUR', category: 'Tanggal & Waktu', description: 'Ambil Jam (0-23).', syntax: 'HOUR(time)', example: '`=HOUR("14:30")` -> 14' },
          { id: 'f54', name: 'MINUTE', category: 'Tanggal & Waktu', description: 'Ambil Menit (0-59).', syntax: 'MINUTE(time)', example: '`=MINUTE("14:30")` -> 30' },
          { id: 'f55', name: 'SECOND', category: 'Tanggal & Waktu', description: 'Ambil Detik (0-59).', syntax: 'SECOND(time)', example: '`=SECOND("14:30:15")` -> 15' },
          { id: 'f56', name: 'TIME', category: 'Tanggal & Waktu', description: 'Buat waktu dari jam, mnt, dtk.', syntax: 'TIME(hour, min, sec)', example: '`=TIME(14, 30, 0)`' },
          { id: 'f57', name: 'EDATE', category: 'Tanggal & Waktu', description: 'Tanggal X bulan ke depan/belakang.', syntax: 'EDATE(start_date, months)', example: '`=EDATE(A1, 3)` (3 bulan lagi)' },
          { id: 'f58', name: 'EOMONTH', category: 'Tanggal & Waktu', description: 'Akhir bulan dari X bulan ke depan.', syntax: 'EOMONTH(start_date, months)', example: '`=EOMONTH(A1, 0)` (Akhir bulan ini)' },
          { id: 'f59', name: 'YEARFRAC', category: 'Tanggal & Waktu', description: 'Selisih tanggal dalam pecahan tahun.', syntax: 'YEARFRAC(start, end)', example: '`=YEARFRAC(A1, B1)`' },
          { id: 'f60', name: 'DATEDIF', category: 'Tanggal & Waktu', description: 'Hitung selisih (Tahun/Bulan/Hari).', syntax: 'DATEDIF(start, end, unit)', example: '`=DATEDIF(A1, B1, "y")` (Umur)' },
          { id: 'f61', name: 'WORKDAY', category: 'Tanggal & Waktu', description: 'Tanggal hari kerja ke depan (skip libur).', syntax: 'WORKDAY(start, days, [holidays])', example: '`=WORKDAY(A1, 5)`' },
          { id: 'f62', name: 'NETWORKDAYS', category: 'Tanggal & Waktu', description: 'Jumlah hari kerja antar 2 tanggal.', syntax: 'NETWORKDAYS(start, end, [holidays])', example: '`=NETWORKDAYS(A1, B1)`' },
          { id: 'f63', name: 'NETWORKDAYS.INTL', category: 'Tanggal & Waktu', description: 'Hari kerja dengan weekend custom.', syntax: 'NETWORKDAYS.INTL(...)', example: 'Bisa set Jumat libur saja.' },
          { id: 'f64', name: 'AND', category: 'Logika', description: 'TRUE jika SEMUA benar.', syntax: 'AND(log1, log2...)', example: '`=AND(A1>0, A1<10)`' },
          { id: 'f65', name: 'OR', category: 'Logika', description: 'TRUE jika SALAH SATU benar.', syntax: 'OR(log1, log2...)', example: '`=OR(A1="A", A1="B")`' },
          { id: 'f66', name: 'NOT', category: 'Logika', description: 'Membalik nilai (True jadi False).', syntax: 'NOT(logic)', example: '`=NOT(A1="Oke")`' },
          { id: 'f67', name: 'IFS', category: 'Logika', description: 'IF bertingkat tanpa nesting.', syntax: 'IFS(test1, val1, test2, val2...)', example: '`=IFS(A1>90,"A", A1>80,"B")`' },
          { id: 'f68', name: 'IFERROR', category: 'Logika', description: 'Ganti pesan error dengan nilai lain.', syntax: 'IFERROR(value, value_if_error)', example: '`=IFERROR(1/0, "Error")`' },
          { id: 'f69', name: 'EXACT', category: 'Teks', description: 'Cek kesamaan teks (Case Sensitive).', syntax: 'EXACT(txt1, txt2)', example: '`=EXACT("a", "A")` -> FALSE' },
          { id: 'f70', name: 'RANK', category: 'Statistik', description: 'Ranking angka.', syntax: 'RANK(number, ref)', example: '`=RANK(A1, A1:A10)`' },
          { id: 'f71', name: 'ABS', category: 'Matematika', description: 'Nilai absolut (positifkan negatif).', syntax: 'ABS(num)', example: '`=ABS(-5)` -> 5' },
          { id: 'f72', name: 'RAND', category: 'Matematika', description: 'Acak 0-1.', syntax: 'RAND()', example: '`=RAND()`' },
          { id: 'f73', name: 'RANDBETWEEN', category: 'Matematika', description: 'Acak bilangan bulat di antara batas.', syntax: 'RANDBETWEEN(bot, top)', example: '`=RANDBETWEEN(1, 100)`' },
          { id: 'f74', name: 'MODE', category: 'Statistik', description: 'Nilai yang paling sering muncul.', syntax: 'MODE(range)', example: '`=MODE(A1:A10)`' },
          { id: 'f75', name: 'ROMAN', category: 'Matematika', description: 'Angka ke Romawi.', syntax: 'ROMAN(num)', example: '`=ROMAN(10)` -> X' },
          { id: 'f76', name: 'ARABIC', category: 'Matematika', description: 'Romawi ke Angka.', syntax: 'ARABIC(text)', example: '`=ARABIC("X")` -> 10' },
          { id: 'f77', name: 'TRUE', category: 'Logika', description: 'Menghasilkan nilai logika TRUE.', syntax: 'TRUE()', example: '`=TRUE()`' },
          { id: 'f78', name: 'FALSE', category: 'Logika', description: 'Menghasilkan nilai logika FALSE.', syntax: 'FALSE()', example: '`=FALSE()`' },
          { id: 'f79', name: 'IFNA', category: 'Logika', description: 'Tangani error #N/A saja.', syntax: 'IFNA(value, val_if_na)', example: 'Khusus error VLOOKUP.' },
          { id: 'f80', name: 'XOR', category: 'Logika', description: 'Exclusive OR.', syntax: 'XOR(...)', example: 'Ganjil TRUE.' },
          { id: 'f81', name: 'SWITCH', category: 'Logika', description: 'Cocokkan nilai dengan hasil.', syntax: 'SWITCH(expr, val1, res1...)', example: '`=SWITCH(A1, 1,"Senin", 2,"Selasa")`' },
          { id: 'f82', name: 'CHAR', category: 'Teks', description: 'Kode ASCII ke Karakter.', syntax: 'CHAR(num)', example: '`=CHAR(65)` -> "A"' },
          { id: 'f83', name: 'CODE', category: 'Teks', description: 'Karakter ke Kode ASCII.', syntax: 'CODE(text)', example: '`=CODE("A")` -> 65' },
          { id: 'f84', name: 'CONCAT', category: 'Teks', description: 'Gabung teks (lebih baru).', syntax: 'CONCAT(text...)', example: '`=CONCAT(A1:A5)`' },
          { id: 'f85', name: 'DOLLAR', category: 'Teks', description: 'Format angka ke mata uang (teks).', syntax: 'DOLLAR(num)', example: '`=DOLLAR(1000)`' },
          { id: 'f86', name: 'FIND', category: 'Teks', description: 'Cari posisi teks (Case Sensitive).', syntax: 'FIND(find, within)', example: '`=FIND("a", "Halo")`' },
          { id: 'f87', name: 'SEARCH', category: 'Teks', description: 'Cari posisi teks (Tidak Case Sensitive).', syntax: 'SEARCH(find, within)', example: '`=SEARCH("a", "Halo")`' },
          { id: 'f88', name: 'REPLACE', category: 'Teks', description: 'Ganti teks berdasarkan posisi.', syntax: 'REPLACE(old, start, num, new)', example: 'Ganti karakter ke-3.' },
          { id: 'f89', name: 'SUBSTITUTE', category: 'Teks', description: 'Ganti teks berdasarkan isi.', syntax: 'SUBSTITUTE(text, old, new)', example: 'Ganti "Spasi" jadi "-".' },
          { id: 'f90', name: 'REPT', category: 'Teks', description: 'Ulangi teks.', syntax: 'REPT(text, times)', example: '`=REPT("*", 5)` -> *****' },
          { id: 'f91', name: 'TEXT', category: 'Teks', description: 'Format angka jadi teks kustom.', syntax: 'TEXT(val, format)', example: '`=TEXT(A1, "DD-MM-YY")`' },
          { id: 'f92', name: 'VALUE', category: 'Teks', description: 'Teks angka jadi angka beneran.', syntax: 'VALUE(text)', example: '`=VALUE("123")`' },
          { id: 'f93', name: 'DATEVALUE', category: 'Tanggal & Waktu', description: 'Teks tanggal jadi serial number.', syntax: 'DATEVALUE(date_text)', example: '`=DATEVALUE("1/1/2023")`' },
          { id: 'f94', name: 'DAYS', category: 'Tanggal & Waktu', description: 'Selisih hari.', syntax: 'DAYS(end, start)', example: '`=DAYS(B1, A1)`' },
          { id: 'f95', name: 'DAYS360', category: 'Tanggal & Waktu', description: 'Selisih hari (basis 360 hari/thn).', syntax: 'DAYS360(start, end)', example: 'Untuk akuntansi.' },
          { id: 'f96', name: 'WEEKDAY', category: 'Tanggal & Waktu', description: 'Hari ke berapa (1-7).', syntax: 'WEEKDAY(date)', example: '1 = Minggu (default).' },
          { id: 'f97', name: 'WEEKNUM', category: 'Tanggal & Waktu', description: 'Minggu ke berapa dalam setahun.', syntax: 'WEEKNUM(date)', example: '1-52.' },
          { id: 'f98', name: 'ISOWEEKNUM', category: 'Tanggal & Waktu', description: 'Minggu ke berapa (standar ISO).', syntax: 'ISOWEEKNUM(date)', example: 'Standar Eropa.' },
          { id: 'f99', name: 'TIMEVALUE', category: 'Tanggal & Waktu', description: 'Teks waktu jadi serial number.', syntax: 'TIMEVALUE(time_text)', example: '`=TIMEVALUE("6:00 PM")`' },
          { id: 'f100', name: 'CHOOSE', category: 'Pencarian', description: 'Pilih nilai berdasarkan indeks.', syntax: 'CHOOSE(idx, val1, val2...)', example: '`=CHOOSE(2, "A","B","C")` -> "B"' },
          { id: 'f101', name: 'INDIRECT', category: 'Pencarian', description: 'Referensi sel dari teks.', syntax: 'INDIRECT(ref_text)', example: '`=INDIRECT("A1")`' },
          { id: 'f102', name: 'LOOKUP', category: 'Pencarian', description: 'Pencarian backward compatibility.', syntax: 'LOOKUP(...)', example: 'Jarang dipakai, pakai XLOOKUP.' },
          { id: 'f103', name: 'ROW', category: 'Pencarian', description: 'Nomor baris.', syntax: 'ROW([ref])', example: '`=ROW()` -> baris aktif.' },
          { id: 'f104', name: 'ROWS', category: 'Pencarian', description: 'Jumlah baris dalam array.', syntax: 'ROWS(array)', example: '`=ROWS(A1:A10)` -> 10' },
          { id: 'f105', name: 'COLUMN', category: 'Pencarian', description: 'Nomor kolom.', syntax: 'COLUMN([ref])', example: '`=COLUMN(C1)` -> 3' },
          { id: 'f106', name: 'COLUMNS', category: 'Pencarian', description: 'Jumlah kolom dalam array.', syntax: 'COLUMNS(array)', example: '`=COLUMNS(A1:C1)` -> 3' },
          { id: 'f107', name: 'TRANSPOSE', category: 'Pencarian', description: 'Balik orientasi (Vertikal <-> Horizontal).', syntax: 'TRANSPOSE(array)', example: 'Tukar baris jadi kolom.' },
          { id: 'f108', name: 'SORT', category: 'Pencarian', description: 'Urutkan data (Dynamic).', syntax: 'SORT(array, idx, order)', example: '`=SORT(A1:A10)`' },
          { id: 'f109', name: 'UNIQUE', category: 'Pencarian', description: 'Ambil data unik saja.', syntax: 'UNIQUE(array)', example: '`=UNIQUE(A1:A10)`' },
          { id: 'f110', name: 'SEQUENCE', category: 'Matematika', description: 'Buat urutan angka.', syntax: 'SEQUENCE(rows)', example: '`=SEQUENCE(10)` -> 1..10' },
          { id: 'f111', name: 'RANDARRAY', category: 'Matematika', description: 'Buat array acak.', syntax: 'RANDARRAY(rows, cols)', example: 'Isi tabel dengan angka acak.' },
          { id: 'f112', name: 'POWER', category: 'Matematika', description: 'Pangkat.', syntax: 'POWER(base, exp)', example: '`=POWER(2, 3)` -> 8' },
          { id: 'f113', name: 'SQRT', category: 'Matematika', description: 'Akar kuadrat.', syntax: 'SQRT(num)', example: '`=SQRT(9)` -> 3' },
          { id: 'f114', name: 'MOD', category: 'Matematika', description: 'Sisa bagi.', syntax: 'MOD(num, divisor)', example: '`=MOD(10, 3)` -> 1' },
          { id: 'f115', name: 'PI', category: 'Matematika', description: 'Nilai Pi.', syntax: 'PI()', example: '3.14159...' },
          { id: 'f116', name: 'PRODUCT', category: 'Matematika', description: 'Mengalikan semua angka.', syntax: 'PRODUCT(num1...)', example: '`=PRODUCT(A1:A5)`' },
          { id: 'f117', name: 'SUBTOTAL', category: 'Matematika', description: 'Hitung subtotal (abaikan filter).', syntax: 'SUBTOTAL(func, ref)', example: 'Penting untuk filter data.' },
          { id: 'f118', name: 'MEDIAN', category: 'Statistik', description: 'Nilai tengah.', syntax: 'MEDIAN(num...)', example: '`=MEDIAN(1, 3, 9)` -> 3' },
          { id: 'f119', name: 'STDEV.P', category: 'Statistik', description: 'Standar deviasi (populasi).', syntax: 'STDEV.P(...)', example: 'Statistik.' },
          { id: 'f120', name: 'STDEV.S', category: 'Statistik', description: 'Standar deviasi (sampel).', syntax: 'STDEV.S(...)', example: 'Statistik.' },
          { id: 'f121', name: 'VAR.P', category: 'Statistik', description: 'Varians (populasi).', syntax: 'VAR.P(...)', example: 'Statistik.' },
          { id: 'f122', name: 'VAR.S', category: 'Statistik', description: 'Varians (sampel).', syntax: 'VAR.S(...)', example: 'Statistik.' },
          { id: 'f123', name: 'ISBLANK', category: 'Informasi', description: 'Cek sel kosong.', syntax: 'ISBLANK(val)', example: 'TRUE jika kosong.' },
          { id: 'f124', name: 'ISNUMBER', category: 'Informasi', description: 'Cek apakah angka.', syntax: 'ISNUMBER(val)', example: 'TRUE jika angka.' },
          { id: 'f125', name: 'ISTEXT', category: 'Informasi', description: 'Cek apakah teks.', syntax: 'ISTEXT(val)', example: 'TRUE jika teks.' },
          { id: 'f126', name: 'ISERROR', category: 'Informasi', description: 'Cek apakah error.', syntax: 'ISERROR(val)', example: 'TRUE jika error apapun.' },
          { id: 'f127', name: 'ISLOGICAL', category: 'Informasi', description: 'Cek boolean.', syntax: 'ISLOGICAL(val)', example: 'TRUE jika TRUE/FALSE.' },
          { id: 'f128', name: 'ISNONTEXT', category: 'Informasi', description: 'Cek bukan teks.', syntax: 'ISNONTEXT(val)', example: 'Angka/Kosong = TRUE.' },
          { id: 'f129', name: 'ISEVEN', category: 'Informasi', description: 'Cek Genap.', syntax: 'ISEVEN(num)', example: '2 -> TRUE.' },
          { id: 'f130', name: 'ISODD', category: 'Informasi', description: 'Cek Ganjil.', syntax: 'ISODD(num)', example: '1 -> TRUE.' },
          { id: 'f131', name: 'N', category: 'Informasi', description: 'Konversi ke angka.', syntax: 'N(val)', example: 'TRUE -> 1.' },
          { id: 'f132', name: 'NA', category: 'Informasi', description: 'Buat error #N/A.', syntax: 'NA()', example: 'Untuk testing error.' },
          { id: 'f133', name: 'PMT', category: 'Finansial', description: 'Hitung angsuran pinjaman.', syntax: 'PMT(rate, nper, pv)', example: 'Cicilan KPR/Mobil.' },
          { id: 'f134', name: 'FV', category: 'Finansial', description: 'Future Value (Nilai masa depan).', syntax: 'FV(rate, nper, pmt)', example: 'Hasil investasi.' },
          { id: 'f135', name: 'PV', category: 'Finansial', description: 'Present Value (Nilai saat ini).', syntax: 'PV(rate, nper, pmt)', example: 'Nilai uang sekarang.' },
          { id: 'f136', name: 'NPER', category: 'Finansial', description: 'Jumlah periode.', syntax: 'NPER(rate, pmt, pv)', example: 'Berapa bulan lunas?' }
        ];
        // --- (AKHIR) Database Rumus Excel ---

        // --- (MULAI) Database Shortcut Excel (LENGKAP: 130 Shortcut) ---
        const shortcutData = [
          // Navigasi
          { id: 's1', category: 'Navigasi', combo: 'Ctrl + Panah', mac: 'Cmd + Panah', desc: 'Pindah ke tepi data (sel terakhir isi).' },
          { id: 's2', category: 'Navigasi', combo: 'Ctrl + Home', mac: 'Cmd + Home', desc: 'Pindah ke sel A1.' },
          { id: 's3', category: 'Navigasi', combo: 'Ctrl + End', mac: 'Cmd + End', desc: 'Pindah ke sel terakhir digunakan.' },
          { id: 's4', category: 'Navigasi', combo: 'Ctrl + PageUp/Down', mac: 'Cmd + PageUp/Down', desc: 'Pindah antar sheet.' },
          { id: 's5', category: 'Navigasi', combo: 'F5 / Ctrl + G', mac: 'F5 / Cmd + G', desc: 'Go To (Pergi Ke).' },
          // Seleksi
          { id: 's6', category: 'Seleksi', combo: 'Shift + Panah', mac: 'Shift + Panah', desc: 'Perluas seleksi satu sel.' },
          { id: 's7', category: 'Seleksi', combo: 'Ctrl + Shift + Panah', mac: 'Cmd + Shift + Panah', desc: 'Perluas seleksi sampai tepi.' },
          { id: 's8', category: 'Seleksi', combo: 'Ctrl + A', mac: 'Cmd + A', desc: 'Pilih Semua.' },
          { id: 's9', category: 'Seleksi', combo: 'Ctrl + Space', mac: 'Ctrl + Space', desc: 'Pilih Kolom.' },
          { id: 's10', category: 'Seleksi', combo: 'Shift + Space', mac: 'Shift + Space', desc: 'Pilih Baris.' },
          // Edit
          { id: 's11', category: 'Edit', combo: 'F2', mac: 'F2 / Ctrl + U', desc: 'Edit sel aktif.' },
          { id: 's12', category: 'Edit', combo: 'Ctrl + C', mac: 'Cmd + C', desc: 'Copy.' },
          { id: 's13', category: 'Edit', combo: 'Ctrl + X', mac: 'Cmd + X', desc: 'Cut.' },
          { id: 's14', category: 'Edit', combo: 'Ctrl + V', mac: 'Cmd + V', desc: 'Paste.' },
          { id: 's15', category: 'Edit', combo: 'Ctrl + Z', mac: 'Cmd + Z', desc: 'Undo.' },
          { id: 's16', category: 'Edit', combo: 'Ctrl + Y', mac: 'Cmd + Y', desc: 'Redo.' },
          { id: 's17', category: 'Edit', combo: 'Ctrl + D', mac: 'Cmd + D', desc: 'Fill Down (Salin ke bawah).' },
          { id: 's18', category: 'Edit', combo: 'Ctrl + R', mac: 'Cmd + R', desc: 'Fill Right (Salin ke kanan).' },
          { id: 's19', category: 'Edit', combo: 'Ctrl + F', mac: 'Cmd + F', desc: 'Find (Cari).' },
          { id: 's20', category: 'Edit', combo: 'Ctrl + H', mac: 'Cmd + H', desc: 'Replace (Ganti).' },
          { id: 's21', category: 'Edit', combo: 'Alt + Enter', mac: 'Ctrl+Opt+Enter', desc: 'Baris baru dalam sel.' },
          { id: 's22', category: 'Edit', combo: 'Ctrl + ;', mac: 'Cmd + ;', desc: 'Input Tanggal Hari Ini.' },
          { id: 's23', category: 'Edit', combo: 'Ctrl + Shift + :', mac: 'Cmd + Shift + :', desc: 'Input Waktu Sekarang.' },
          // Format
          { id: 's24', category: 'Format', combo: 'Ctrl + 1', mac: 'Cmd + 1', desc: 'Buka Format Cells.' },
          { id: 's25', category: 'Format', combo: 'Ctrl + B', mac: 'Cmd + B', desc: 'Bold.' },
          { id: 's26', category: 'Format', combo: 'Ctrl + I', mac: 'Cmd + I', desc: 'Italic.' },
          { id: 's27', category: 'Format', combo: 'Ctrl + U', mac: 'Cmd + U', desc: 'Underline.' },
          { id: 's28', category: 'Format', combo: 'Ctrl + Shift + $', mac: 'Cmd + Shift + $', desc: 'Format Currency.' },
          { id: 's29', category: 'Format', combo: 'Ctrl + Shift + %', mac: 'Cmd + Shift + %', desc: 'Format Persen.' },
          { id: 's30', category: 'Format', combo: 'Ctrl + Shift + #', mac: 'Cmd + Shift + #', desc: 'Format Tanggal.' },
          { id: 's31', category: 'Format', combo: 'Ctrl + Shift + ~', mac: 'Cmd + Shift + ~', desc: 'Format General.' },
          { id: 's32', category: 'Format', combo: 'Ctrl + Shift + &', mac: 'Cmd + Shift + &', desc: 'Tambah Border Luar.' },
          { id: 's33', category: 'Format', combo: 'Ctrl + Shift + _', mac: 'Cmd + Shift + _', desc: 'Hapus Border.' },
          // Data & Rumus
          { id: 's34', category: 'Data', combo: 'Ctrl + T', mac: 'Cmd + T', desc: 'Buat Tabel (Table).' },
          { id: 's35', category: 'Data', combo: 'Alt + A + T', mac: '-', desc: 'Menu Filter.' },
          { id: 's36', category: 'Data', combo: 'Ctrl + Shift + L', mac: 'Cmd + Shift + F', desc: 'Toggle (memasang/melepas) filter data.' },
          { id: 's37', category: 'Fungsi & Kalkulasi', combo: 'Alt + =', mac: 'Cmd + Shift + T', desc: 'AutoSum.' },
          { id: 's38', category: 'Fungsi & Kalkulasi', combo: 'F4', mac: 'F4 / Cmd + T', desc: 'Kunci Rumus ($) / Ulangi Aksi.' },
          { id: 's39', category: 'Fungsi & Kalkulasi', combo: 'Ctrl + `', mac: 'Cmd + `', desc: 'Tampilkan/Sembunyikan Rumus.' },
          { id: 's40', category: 'Fungsi & Kalkulasi', combo: 'Ctrl + \'', mac: 'Cmd + \'', desc: 'Copy rumus dari atas (exact).' },
          // Workbook
          { id: 's41', category: 'Workbook', combo: 'Ctrl + N', mac: 'Cmd + N', desc: 'Workbook Baru.' },
          { id: 's42', category: 'Workbook', combo: 'Ctrl + O', mac: 'Cmd + O', desc: 'Buka File.' },
          { id: 's43', category: 'Workbook', combo: 'Ctrl + S', mac: 'Cmd + S', desc: 'Simpan.' },
          { id: 's44', category: 'Workbook', combo: 'F12', mac: 'Cmd + Shift + S', desc: 'Save As.' },
          { id: 's45', category: 'Workbook', combo: 'Ctrl + W', mac: 'Cmd + W', desc: 'Tutup Workbook.' },
          { id: 's46', category: 'Workbook', combo: 'Ctrl + P', mac: 'Cmd + P', desc: 'Mencetak (Print).' },
          // Tambahan
          { id: 's47', category: 'Workbook', combo: 'Alt + F4', mac: 'Cmd + Q', desc: 'Tutup Excel.' },
          { id: 's48', category: 'Data', combo: 'F1', mac: 'F1', desc: 'Help.' },
          { id: 's49', category: 'Navigasi', combo: 'Ctrl + Tab', mac: 'Ctrl + Tab', desc: 'Pindah antar Workbook.' },
          { id: 's50', category: 'Seleksi', combo: 'Ctrl + Shift + Home', mac: 'Cmd + Shift + Home', desc: 'Seleksi sampai A1.' },
          { id: 's51', category: 'Seleksi', combo: 'Ctrl + Shift + End', mac: 'Cmd + Shift + End', desc: 'Seleksi sampai akhir data.' },
          { id: 's52', category: 'Edit', combo: 'Shift + F2', mac: 'Shift + F2', desc: 'Tambah Komentar.' },
          { id: 's53', category: 'Edit', combo: 'Ctrl + Enter', mac: 'Cmd + Enter', desc: 'Isi sel terseleksi dg data sama.' },
          { id: 's54', category: 'Edit', combo: 'Ctrl + K', mac: 'Cmd + K', desc: 'Hyperlink.' },
          { id: 's55', category: 'Data', combo: 'Alt + Panah Bawah', mac: 'Opt + Down', desc: 'Buka Dropdown List.' },
          { id: 's56', category: 'Data', combo: 'Ctrl + E', mac: '-', desc: 'Flash Fill.' },
          { id: 's57', category: 'Format', combo: 'Ctrl + Shift + !', mac: '-', desc: 'Format Angka (2 desimal).' },
          { id: 's58', category: 'Format', combo: 'Ctrl + Shift + @', mac: '-', desc: 'Format Waktu.' },
          { id: 's59', category: 'Format', combo: 'Ctrl + Shift + ^', mac: '-', desc: 'Format Scientific.' },
          { id: 's60', category: 'Data', combo: 'Alt + F1', mac: 'Opt + F1', desc: 'Buat Chart (Sheet sama).' },
          { id: 's61', category: 'Data', combo: 'F11', mac: 'F11', desc: 'Buat Chart (Sheet baru).' },
          { id: 's62', category: 'Fungsi & Kalkulasi', combo: 'Shift + F3', mac: 'Shift + F3', desc: 'Insert Function Dialog.' },
          { id: 's63', category: 'Fungsi & Kalkulasi', combo: 'Ctrl + Shift + Enter', mac: 'Cmd + Shift + Enter', desc: 'Array Formula (CSE).' },
          { id: 's64', category: 'Fungsi & Kalkulasi', combo: 'F9', mac: 'F9', desc: 'Hitung Ulang (Recalculate).' },
          { id: 's65', category: 'Edit', combo: 'Ctrl + -', mac: 'Cmd + -', desc: 'Hapus Sel/Baris/Kolom.' },
          { id: 's66', category: 'Edit', combo: 'Ctrl + Shift + +', mac: 'Cmd + Shift + +', desc: 'Insert Sel/Baris/Kolom.' },
          { id: 's67', category: 'Format', combo: 'Ctrl + 9', mac: 'Cmd + 9', desc: 'Hide Row.' },
          { id: 's68', category: 'Format', combo: 'Ctrl + 0', mac: 'Cmd + 0', desc: 'Hide Column.' },
          { id: 's69', category: 'Format', combo: 'Ctrl + Shift + 9', mac: 'Cmd + Shift + 9', desc: 'Unhide Row.' },
          { id: 's70', category: 'Format', combo: 'Ctrl + Shift + 0', mac: 'Cmd + Shift + 0', desc: 'Unhide Column.' },
          { id: 's71', category: 'Data', combo: 'Alt + Shift + Right', mac: 'Cmd + Shift + K', desc: 'Group Data.' },
          { id: 's72', category: 'Data', combo: 'Alt + Shift + Left', mac: 'Cmd + Shift + J', desc: 'Ungroup Data.' },
          { id: 's73', category: 'Edit', combo: 'F7', mac: 'F7', desc: 'Spell Check.' },
          { id: 's74', category: 'Developer', combo: 'Alt + F11', mac: 'Opt + F11', desc: 'Buka VBA Editor.' },
          { id: 's75', category: 'Format', combo: 'Ctrl + 5', mac: 'Cmd + Shift + X', desc: 'Strikethrough.' },
          { id: 's76', category: 'Navigasi', combo: 'Home', mac: 'Fn + Left', desc: 'Ke awal baris.' },
          { id: 's77', category: 'Navigasi', combo: 'Ctrl + Backspace', mac: 'Cmd + Del', desc: 'Scroll balik ke sel aktif.' },
          { id: 's78', category: 'Seleksi', combo: 'Shift + F8', mac: 'Shift + F8', desc: 'Add to Selection (Non-contiguous).' },
          { id: 's79', category: 'Seleksi', combo: 'Ctrl + .', mac: 'Ctrl + .', desc: 'Pindah sudut seleksi.' },
          { id: 's80', category: 'Seleksi', combo: 'F8', mac: 'F8', desc: 'Mode Extend Selection.' },
          { id: 's81', category: 'Seleksi Lanjutan', combo: 'Ctrl + Shift + *', mac: 'Ctrl + Shift + Space', desc: 'Menyeleksi wilayah data di sekitar sel aktif.' },
          { id: 's82', category: 'Seleksi Lanjutan', combo: 'Alt + ;', mac: 'Cmd + Shift + Z', desc: 'Menyeleksi HANYA sel yang terlihat (berguna setelah filter/sembunyikan baris).' },
          { id: 's83', category: 'Seleksi Lanjutan', combo: 'Ctrl + [', mac: 'Ctrl + [', desc: 'Pilih Precedents (Direct).' },
          { id: 's84', category: 'Seleksi Lanjutan', combo: 'Ctrl + Shift + {', mac: 'Ctrl + Shift + {', desc: 'Pilih Semua Precedents.' },
          { id: 's85', category: 'Seleksi Lanjutan', combo: 'Ctrl + ]', mac: 'Ctrl + ]', desc: 'Pilih Dependents (Direct).' },
          { id: 's86', category: 'Seleksi Lanjutan', combo: 'Ctrl + Shift + }', mac: 'Ctrl + Shift + }', desc: 'Pilih Semua Dependents.' },
          { id: 's87', category: 'Edit', combo: 'Ctrl + Alt + V', mac: 'Ctrl + Cmd + V', desc: 'Paste Special.' },
          { id: 's88', category: 'Edit', combo: 'Ctrl + \'', mac: 'Ctrl + \'', desc: 'Copy Rumus dari atas.' },
          { id: 's89', category: 'Edit', combo: 'Ctrl + "', mac: '-', desc: 'Copy Nilai dari atas.' },
          { id: 's90', category: 'Edit', combo: 'Backspace', mac: 'Delete', desc: 'Hapus kiri / Balik ke sel aktif.' },
          { id: 's91', category: 'Edit', combo: 'Delete', mac: 'Fn + Del', desc: 'Hapus isi (Clear Content).' },
          { id: 's92', category: 'Edit', combo: 'Tab', mac: 'Tab', desc: 'Ke kanan.' },
          { id: 's93', category: 'Edit', combo: 'Shift + Tab', mac: 'Shift + Tab', desc: 'Ke kiri.' },
          { id: 's94', category: 'Format', combo: 'F4', mac: 'Cmd + Y', desc: 'Repeat Action.' },
          { id: 's95', category: 'Format', combo: 'Ctrl + Shift + F', mac: 'Cmd + Shift + F', desc: 'Membuka tab Font pada dialog "Format Cells".' },
          { id: 's96', category: 'Format', combo: 'Ctrl + Shift + ^', mac: '-', desc: 'Format Scientific.' },
          { id: 's97', category: 'Fungsi & Kalkulasi', combo: 'F9', mac: 'F9', desc: 'Calculate All.' },
          { id: 's98', category: 'Fungsi & Kalkulasi', combo: 'Shift + F9', mac: 'Shift + F9', desc: 'Calculate Sheet.' },
          { id: 's99', category: 'Fungsi & Kalkulasi', combo: 'Ctrl + Alt + F9', mac: '-', desc: 'Force Calculate All.' },
          { id: 's100', category: 'Fungsi & Kalkulasi', combo: 'Ctrl + Shift + U', mac: 'Ctrl + Shift + U', desc: 'Expand Formula Bar.' },
          { id: 's101', category: 'Fungsi & Kalkulasi', combo: 'Ctrl + Shift + A', mac: 'Ctrl + Shift + A', desc: 'Insert Argumen Function.' },
          { id: 's102', category: 'Data', combo: 'Ctrl + 8', mac: 'Ctrl + 8', desc: 'Toggle Outline.' },
          { id: 's103', category: 'Data', combo: 'Ctrl + Shift + O', mac: 'Ctrl + Shift + O', desc: 'Pilih sel berkomentar.' },
          { id: 's104', category: 'Data', combo: 'Alt + D + L', mac: '-', desc: 'Data Validation.' },
          { id: 's105', category: 'PivotTable', combo: 'Alt + D + P', mac: '-', desc: 'Pivot Wizard.' },
          { id: 's106', category: 'PivotTable', combo: 'Ctrl + A', mac: 'Cmd + A', desc: 'Pilih PivotTable.' },
          { id: 's107', category: 'PivotTable', combo: 'Alt + Shift + Right', mac: '-', desc: 'Group Pivot Item.' },
          { id: 's108', category: 'PivotTable', combo: 'Alt + Shift + Left', mac: '-', desc: 'Ungroup Pivot Item.' },
          { id: 's109', category: 'Workbook', combo: 'Ctrl + F4', mac: 'Cmd + W', desc: 'Tutup Window.' },
          { id: 's110', category: 'Workbook', combo: 'Shift + F11', mac: 'Shift + F11', desc: 'Sheet Baru.' },
          { id: 's111', category: 'Workbook', combo: 'Ctrl + F9', mac: 'Cmd + M', desc: 'Minimize.' },
          { id: 's112', category: 'Workbook', combo: 'Ctrl + F10', mac: '-', desc: 'Maximize.' },
          { id: 's113', category: 'Workbook', combo: 'Ctrl + F5', mac: '-', desc: 'Restore.' },
          { id: 's114', category: 'Dialog Boxes', combo: 'Tab', mac: 'Tab', desc: 'Next Control.' },
          { id: 's115', category: 'Dialog Boxes', combo: 'Shift + Tab', mac: 'Shift + Tab', desc: 'Prev Control.' },
          { id: 's116', category: 'Dialog Boxes', combo: 'Ctrl + Tab', mac: 'Ctrl + Tab', desc: 'Next Tab.' },
          { id: 's117', category: 'Dialog Boxes', combo: 'Ctrl + Shift + Tab', mac: 'Ctrl + Shift + Tab', desc: 'Prev Tab.' },
          { id: 's118', category: 'Dialog Boxes', combo: 'Enter', mac: 'Return', desc: 'OK.' },
          { id: 's119', category: 'Dialog Boxes', combo: 'Esc', mac: 'Esc', desc: 'Cancel.' },
          { id: 's120', category: 'Dialog Boxes', combo: 'Space', mac: 'Space', desc: 'Toggle Checkbox.' },
          { id: 's121', category: 'Lain-lain', combo: 'Alt + F8', mac: 'Opt + F8', desc: 'Macro Dialog.' },
          { id: 's122', category: 'Lain-lain', combo: 'Alt', mac: '-', desc: 'Aktifkan Key Tips.' },
          { id: 's123', category: 'Lain-lain', combo: 'Alt + Space', mac: '-', desc: 'System Menu.' },
          { id: 's124', category: 'Lain-lain', combo: 'Shift + F7', mac: 'Shift + F7', desc: 'Thesaurus.' },
          { id: 's125', category: 'Lain-lain', combo: 'F7', mac: 'F7', desc: 'Spelling.' },
          { id: 's126', category: 'Fungsi & Kalkulasi', combo: 'Alt + H, U, S', mac: '-', desc: 'Menu AutoSum.' },
          { id: 's127', category: 'Fungsi & Kalkulasi', combo: 'Alt + H, U, A', mac: '-', desc: 'Menu Average.' },
          { id: 's128', category: 'Fungsi & Kalkulasi', combo: 'Alt + H, U, M', mac: '-', desc: 'Menu Max.' },
          { id: 's129', category: 'Fungsi & Kalkulasi', combo: 'Alt + H, U, I', mac: '-', desc: 'Menu Min.' },
          { id: 's130', category: 'Fungsi & Kalkulasi', combo: 'Alt + H, U, C', mac: '-', desc: 'Menu Count.' }
        ];
        // --- (AKHIR) Database Shortcut Excel ---
        
        // Hooks
        const useDarkMode = () => {
          const [isDarkMode, setIsDarkMode] = useState(() => {
            const saved = localStorage.getItem('darkMode');
            if (saved !== null) return JSON.parse(saved);
            return window.matchMedia && window.matchMedia('(prefers-color-scheme: dark)').matches;
          });
          useEffect(() => {
            if (isDarkMode) document.documentElement.classList.add('dark');
            else document.documentElement.classList.remove('dark');
            localStorage.setItem('darkMode', JSON.stringify(isDarkMode));
          }, [isDarkMode]);
          const toggleDarkMode = () => setIsDarkMode(prev => !prev);
          return [isDarkMode, toggleDarkMode];
        };

        const useBookmarks = (allData) => {
          const [bookmarkedIds, setBookmarkedIds] = useState(() => {
            const saved = localStorage.getItem('excelBookmarks');
            return saved ? JSON.parse(saved) : [];
          });
          useEffect(() => { localStorage.setItem('excelBookmarks', JSON.stringify(bookmarkedIds)); }, [bookmarkedIds]);
          const toggleBookmark = useCallback((id) => {
            setBookmarkedIds(prev => prev.includes(id) ? prev.filter(bid => bid !== id) : [...prev, id]);
          }, []);
          const bookmarkedItems = useMemo(() => allData.filter(item => bookmarkedIds.includes(item.id)), [allData, bookmarkedIds]);
          return { bookmarkedIds, toggleBookmark, bookmarkedItems };
        };

        const useDailyLearn = (formulas, shortcuts) => {
          const [dailyItems, setDailyItems] = useState({ formulas: [], shortcuts: [] });
          useEffect(() => {
            const today = new Date().toDateString();
            const lastVisit = localStorage.getItem('dailyLearnLastVisit');
            const savedItems = localStorage.getItem('dailyLearnItems');
            if (lastVisit === today && savedItems) {
              setDailyItems(JSON.parse(savedItems));
            } else {
              const shuffledF = [...formulas].sort(() => 0.5 - Math.random()).slice(0, 5);
              const shuffledS = [...shortcuts].sort(() => 0.5 - Math.random()).slice(0, 5);
              const newItems = { formulas: shuffledF, shortcuts: shuffledS };
              setDailyItems(newItems);
              localStorage.setItem('dailyLearnItems', JSON.stringify(newItems));
              localStorage.setItem('dailyLearnLastVisit', today);
            }
          }, [formulas, shortcuts]);
          return dailyItems;
        };

        // Hook Baru untuk Latihan Soal
        const useExercises = () => {
            const [exercises, setExercises] = useState(() => {
                const saved = localStorage.getItem('excelExercises');
                if (saved) return JSON.parse(saved);
                return [
                    {
                        id: 'ex_init_1',
                        title: 'Latihan Soal Excel Dasar - Paket 1',
                        description: 'Latihan Excel untuk menghitung pengeluaran mingguan berupa uang makan, uang lembur, dan total keseluruhan dengan menggunakan rumus perkalian dan penjumlahan.',
                        url: 'https://drive.google.com/file/d/1PFhd6qDexP7cW394eeMN-WVIqiFkXfiq/view',
                        date: new Date().toLocaleDateString('id-ID')
                    },
                    {
                        id: 'ex_init_2',
                        title: 'Latihan Soal Excel Dasar - Paket 2',
                        description: 'File latihan ini berisi tugas pengolahan data menggunakan VLOOKUP untuk mencari informasi kue, perhitungan total belanja, serta penentuan klasifikasi dengan rumus IF. Materi ini dirancang untuk melatih pemahaman dasar hingga menengah dalam penggunaan fungsi Excel.',
                        url: 'https://drive.google.com/file/d/1mTN6vNgtCNOGFQiVYdDoEFq2ay3z_nh5/view',
                        date: new Date().toLocaleDateString('id-ID')
                    },
                    {
                        id: 'ex_init_3',
                        title: 'Latihan Soal Excel Dasar - Paket 3',
                        description: 'Latihan Excel ini mengajarkan cara mencari nama obat dan harga satuan menggunakan VLOOKUP, menghitung total harga, menentukan diskon berdasarkan jenis pembayaran, memberikan bonus sesuai ketentuan, menghitung pajak, serta memperoleh total bayar akhir. latihan ini dirancang untuk memperkuat kemampuan dasar dalam penggunaan fungsi logika dan perhitungan pada Excel.',
                        url: 'https://drive.google.com/file/d/1RIa715zm69EwGEHrY68tPLWtXG1tCuX5/view',
                        date: new Date().toLocaleDateString('id-ID')
                    },
                    {
                        id: 'ex_init_4',
                        title: 'Latihan Soal Excel Dasar - Paket 4',
                        description: 'Latihan Excel ini mengajarkan cara menghitung total omset, rata-rata omset, menentukan status berdasarkan kriteria penjualan, serta membuat peringkat kinerja pegawai. Peserta juga diminta mencari data tambahan seperti omset tertinggi, terendah, total keseluruhan, dan jumlah pegawai lulus menggunakan berbagai fungsi Excel seperti SUM, AVERAGE, IF, COUNT, MAX, MIN, SUMIF, COUNTIF, dan RANK. Soal ini cocok untuk pemula hingga menengah yang ingin memperdalam keterampilan analisis data di Excel.',
                        url: 'https://drive.google.com/file/d/1ExNhglqdfqO-8PxNyzZTWWw7jstiKlsp/view',
                        date: new Date().toLocaleDateString('id-ID')
                    }
                ];
            });

            useEffect(() => {
                localStorage.setItem('excelExercises', JSON.stringify(exercises));
            }, [exercises]);

            const addExercise = (title, description, url) => {
                const newEx = {
                    id: 'ex_' + Date.now(),
                    title,
                    description,
                    url,
                    date: new Date().toLocaleDateString('id-ID')
                };
                setExercises(prev => [newEx, ...prev]);
            };

            const deleteExercise = (id) => {
                setExercises(prev => prev.filter(ex => ex.id !== id));
            };

            return { exercises, addExercise, deleteExercise };
        };

        const useAiHelper = () => {
          const [aiResponse, setAiResponse] = useState('');
          const [isLoading, setIsLoading] = useState(false);
          const [error, setError] = useState(null);
          const apiKey = "AIzaSyBDOt50DelrXlXuyUGvrSt-llEiARmQLzU"; 
          const apiUrl = `https://generativelanguage.googleapis.com/v1beta/models/gemini-2.5-flash-preview-09-2025:generateContent?key=${apiKey}`;
          const fetchWithBackoff = async (payload, retries = 2, delay = 1000) => {
            try {
              const res = await fetch(apiUrl, { method: 'POST', headers: {'Content-Type': 'application/json'}, body: JSON.stringify(payload) });
              if (!res.ok) { if (res.status === 429 && retries > 0) { await new Promise(r => setTimeout(r, delay)); return fetchWithBackoff(payload, retries-1, delay*2); } throw new Error(res.statusText); }
              return res.json();
            } catch (err) { if (retries > 0) { await new Promise(r => setTimeout(r, delay)); return fetchWithBackoff(payload, retries-1, delay*2); } throw err; }
          };
          const getExplanation = async (query) => {
            setIsLoading(true); setError(null); setAiResponse('');
            try {
              const result = await fetchWithBackoff({ contents: [{ parts: [{ text: query }] }], systemInstruction: { parts: [{ text: "Jawab singkat dalam Bahasa Indonesia tentang Excel. Gunakan markdown." }] } });
              setAiResponse(result.candidates?.[0]?.content?.parts?.[0]?.text || "Error.");
            } catch (err) { setError("Gagal koneksi AI."); } finally { setIsLoading(false); }
          };
          return { getExplanation, aiResponse, isLoading, error };
        };

        // UI Components
        const Icons = {
          Menu: ({ className }) => <svg className={className} fill="none" viewBox="0 0 24 24" stroke="currentColor"><path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M4 6h16M4 12h16m-7 6h7" /></svg>,
          Close: ({ className }) => <svg className={className} fill="none" viewBox="0 0 24 24" stroke="currentColor"><path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M6 18L18 6M6 6l12 12" /></svg>,
          Sun: ({ className }) => <svg className={className} fill="none" viewBox="0 0 24 24" stroke="currentColor"><path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M12 3v1m0 16v1m9-9h-1M4 12H3m15.364 6.364l-.707-.707M6.343 6.343l-.707-.707m12.728 0l-.707.707M6.343 17.657l-.707.707M12 12a3 3 0 11-6 0 3 3 0 016 0z" /></svg>,
          Moon: ({ className }) => <svg className={className} fill="none" viewBox="0 0 24 24" stroke="currentColor"><path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M20.354 15.354A9 9 0 018.646 3.646 9.003 9.003 0 0012 21a9.003 9.003 0 008.354-5.646z" /></svg>,
          Search: ({ className }) => <svg className={className} fill="none" viewBox="0 0 24 24" stroke="currentColor"><path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z" /></svg>,
          Bookmark: ({ className, isFilled }) => <svg className={className} viewBox="0 0 20 20" fill={isFilled ? 'currentColor' : 'none'} stroke="currentColor"><path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M5 4a2 2 0 012-2h6a2 2 0 012 2v14l-5-3-5 3V4z" /></svg>,
          Learn: ({ className }) => <svg className={className} fill="none" viewBox="0 0 24 24" stroke="currentColor"><path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M9.663 17h4.673M12 3v1m6.364 1.636l-.707.707M12 21v-1m-6.364-1.636l.707-.707M3 12h1m16 0h1M6.343 6.343l.707.707m10.607 10.607l.707.707M12 8a4 4 0 100 8 4 4 0 000-8z" /></svg>,
          BookOpen: ({ className }) => <svg className={className} fill="none" viewBox="0 0 24 24" stroke="currentColor"><path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M12 6.253v13.5M4 19.753V6.253a2.25 2.25 0 012.25-2.25h11.5a2.25 2.25 0 012.25 2.25v13.5A2.25 2.25 0 0117.75 22H6.25a2.25 2.25 0 01-2.25-2.25z" /></svg>,
          Keyboard: ({ className }) => <svg className={className} fill="none" viewBox="0 0 24 24" stroke="currentColor"><path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M5 15h.01M8 15h.01M11 15h.01M14 15h.01M17 15h.01M20 15h.01M5 11h.01M8 11h.01M11 11h.01M14 11h.01M17 11h.01M20 11h.01M5 7h.01M8 7h.01M11 7h.01M19 3H5a2 2 0 00-2 2v14a2 2 0 002 2h14a2 2 0 002-2V5a2 2 0 00-2-2z" /></svg>,
          Ai: ({ className }) => <svg className={className} fill="none" viewBox="0 0 24 24" stroke="currentColor"><path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M9.75 17L9 20l-1.75-1.75M9.75 17h4.5M14.25 17l.75 3 1.75-1.75M14.25 17h-4.5M3 12l3 3 3-3M3 12h18M21 12l-3 3-3-3M21 12H3M12 3l3 3 3-3M12 3v18M12 3l-3 3-3-3" /></svg>,
          ArrowUp: ({ className }) => <svg className={className} fill="none" viewBox="0 0 24 24" strokeWidth={1.5} stroke="currentColor"><path strokeLinecap="round" strokeLinejoin="round" d="M4.5 10.5L12 3m0 0l7.5 7.5M12 3v18" /></svg>,
          Download: ({ className }) => <svg className={className} fill="none" viewBox="0 0 24 24" strokeWidth={1.5} stroke="currentColor"><path strokeLinecap="round" strokeLinejoin="round" d="M3 16.5v2.25A2.25 2.25 0 005.25 21h13.5A2.25 2.25 0 0021 18.75V16.5M16.5 12L12 16.5m0 0L7.5 12m4.5 4.5V3" /></svg>,
          Plus: ({ className }) => <svg className={className} fill="none" viewBox="0 0 24 24" strokeWidth={1.5} stroke="currentColor"><path strokeLinecap="round" strokeLinejoin="round" d="M12 4.5v15m7.5-7.5h-15" /></svg>,
          Trash: ({ className }) => <svg className={className} fill="none" viewBox="0 0 24 24" strokeWidth={1.5} stroke="currentColor"><path strokeLinecap="round" strokeLinejoin="round" d="M14.74 9l-.346 9m-4.788 0L9.26 9m9.968-3.21c.342.052.682.107 1.022.166m-1.022-.165L18.16 19.673a2.25 2.25 0 01-2.244 2.077H8.084a2.25 2.25 0 01-2.244-2.077L4.772 5.79m14.456 0a48.108 48.108 0 00-3.478-.397m-12 .562c.34-.059.68-.114 1.022-.165m0 0a48.11 48.11 0 013.478-.397m7.5 0v-.916c0-1.18-.91-2.164-2.09-2.201a51.964 51.964 0 00-3.32 0c-1.18.037-2.09 1.022-2.09 2.201v.916m7.5 0a48.667 48.667 0 00-7.5 0" /></svg>
        };

        const ItemCard = React.memo(({ item, isBookmarked, onBookmark, onClick }) => {
          const isFormula = item.syntax;
          const categoryClass = getCategoryColor(item.category);
          const hoverClass = isFormula ? 'hover:border-blue-400 dark:hover:border-blue-500' : 'hover:border-indigo-400 dark:hover:border-indigo-500';

          return (
            <div
              onClick={() => onClick(item)}
              className={`relative p-4 bg-white dark:bg-gray-800 rounded-xl shadow-sm hover:shadow-lg transition-all duration-300 border border-gray-100 dark:border-gray-700 ${hoverClass} cursor-pointer group`}
            >
              <button
                onClick={(e) => { e.stopPropagation(); onBookmark(item.id); }}
                className="absolute top-3 right-3 p-1.5 rounded-full bg-gray-50 dark:bg-gray-700 text-gray-400 hover:text-yellow-500 dark:hover:text-yellow-400 hover:bg-yellow-50 dark:hover:bg-yellow-900/30 transition-all opacity-0 group-hover:opacity-100 focus:opacity-100"
              >
                <Icons.Bookmark className="w-4 h-4" isFilled={isBookmarked} />
              </button>
              
              <div className="pr-8">
                <h3 className="text-lg font-bold text-gray-900 dark:text-white tracking-tight">{item.name}</h3>
                {isFormula ? (
                    <div className="mt-1.5 bg-slate-50 dark:bg-slate-900/50 px-2 py-1 rounded border border-slate-100 dark:border-slate-800 w-fit max-w-full overflow-hidden">
                        <code className="text-xs text-indigo-600 dark:text-indigo-400 font-mono block truncate">{item.syntax}</code>
                    </div>
                ) : (
                    <div className="mt-2 flex flex-wrap gap-1.5">
                    <kbd className="px-2 py-0.5 text-xs font-semibold font-sans text-gray-600 bg-gray-100 dark:text-gray-300 dark:bg-gray-700/80 rounded-md border-b-2 border-gray-200 dark:border-gray-600 shadow-sm">{item.combo}</kbd>
                    </div>
                )}
              </div>
              <p className="text-sm text-gray-600 dark:text-gray-400 mt-3 leading-relaxed line-clamp-2">{item.desc || item.description}</p>
              {item.category && (
                <span className={`absolute bottom-3 right-3 text-[10px] font-bold px-2 py-0.5 rounded-full uppercase tracking-wider ${categoryClass}`}>
                  {item.category}
                </span>
              )}
            </div>
          );
        });

        // --- Component Definitions (Restored) ---
        const Header = ({ toggleSidebar, toggleDarkMode, isDarkMode, activeViewName }) => (
          <header className="sticky top-0 z-20 flex items-center justify-between w-full h-20 px-6 bg-white/80 dark:bg-gray-900/80 backdrop-blur-md border-b border-gray-200 dark:border-gray-800 transition-colors duration-200">
            <div className="flex items-center">
              <button onClick={toggleSidebar} className="lg:hidden p-2 -ml-2 mr-2 text-gray-600 dark:text-gray-300 rounded-lg hover:bg-gray-100 dark:hover:bg-gray-800">
                <Icons.Menu className="w-6 h-6" />
              </button>
              <div>
                <h2 className="text-xl font-bold text-gray-800 dark:text-white tracking-tight">{activeViewName}</h2>
              </div>
            </div>
            <button
              onClick={toggleDarkMode}
              className="p-2.5 rounded-full bg-gray-100 dark:bg-gray-800 text-gray-600 dark:text-gray-300 hover:bg-gray-200 dark:hover:bg-gray-700 transition-all duration-200 shadow-sm"
              aria-label="Toggle Dark Mode"
            >
              {isDarkMode ? <Icons.Sun className="w-5 h-5 text-amber-400" /> : <Icons.Moon className="w-5 h-5 text-indigo-500" />}
            </button>
          </header>
        );

        const DetailModal = ({ item, isOpen, onClose, isBookmarked, onBookmark }) => {
          if (!isOpen || !item) return null;

          const isFormula = item.syntax;
          const categoryClass = getCategoryColor(item.category);

          const formatExample = (exampleText) => {
            if (!exampleText) return null;
            return exampleText.split('\n').map((line, i) => (
              <p key={i} className="mb-3 last:mb-0 leading-relaxed">
                {line.split('`').map((part, j) =>
                  j % 2 === 1 ? <code key={j} className="bg-blue-50 dark:bg-blue-900/30 text-blue-600 dark:text-blue-300 px-1.5 py-0.5 rounded text-sm font-mono border border-blue-100 dark:border-blue-800">{part}</code> : part
                )}
              </p>
            ));
          };
          
          return (
            <div
              className="fixed inset-0 bg-gray-900/60 backdrop-blur-sm z-50 flex items-center justify-center p-4 animate-in fade-in duration-200"
              onClick={onClose}
            >
              <div
                className="relative w-full max-w-2xl max-h-[85vh] bg-white dark:bg-gray-900 rounded-2xl shadow-2xl overflow-hidden border border-gray-200 dark:border-gray-800 animate-in zoom-in-95 duration-200"
                onClick={(e) => e.stopPropagation()}
              >
                <header className="flex items-start justify-between p-6 border-b border-gray-100 dark:border-gray-800 bg-gray-50/50 dark:bg-gray-800/50">
                  <div className="pr-4">
                    <div className="flex items-center gap-3 mb-2">
                        <h2 className="text-2xl font-bold text-gray-900 dark:text-white">{item.name}</h2>
                        <span className={`text-xs font-bold px-2.5 py-1 rounded-full uppercase tracking-wider ${categoryClass}`}>
                            {item.category}
                        </span>
                    </div>
                    {isFormula ? (
                      <div className="bg-slate-100 dark:bg-slate-800 px-3 py-2 rounded-lg font-mono text-sm text-slate-700 dark:text-slate-300 border border-slate-200 dark:border-slate-700 inline-block">
                        {item.syntax}
                      </div>
                    ) : (
                      <div className="flex flex-wrap gap-2">
                        <kbd className="px-3 py-1.5 text-sm font-bold font-sans text-gray-700 bg-white dark:text-gray-200 dark:bg-gray-700 rounded-lg border-b-4 border-gray-200 dark:border-gray-600 shadow-sm">{item.combo}</kbd>
                        {item.mac !== 'N/A' && <kbd className="px-3 py-1.5 text-sm font-bold font-sans text-gray-500 bg-gray-50 dark:text-gray-400 dark:bg-gray-800 rounded-lg border border-gray-200 dark:border-gray-700 flex items-center">Mac: {item.mac}</kbd>}
                      </div>
                    )}
                  </div>
                  <div className="flex items-center gap-2">
                     <button
                      onClick={() => onBookmark(item.id)}
                      className="p-2.5 rounded-full bg-white dark:bg-gray-800 text-gray-400 hover:text-yellow-500 dark:hover:text-yellow-400 shadow-sm border border-gray-100 dark:border-gray-700 transition-colors"
                      aria-label="Bookmark"
                    >
                      <Icons.Bookmark className="w-5 h-5" isFilled={isBookmarked} />
                    </button>
                    <button
                      onClick={onClose}
                      className="p-2.5 rounded-full bg-white dark:bg-gray-800 text-gray-400 hover:text-red-500 dark:hover:text-red-400 shadow-sm border border-gray-100 dark:border-gray-700 transition-colors"
                      aria-label="Tutup"
                    >
                      <Icons.Close className="w-5 h-5" />
                    </button>
                  </div>
                </header>
                
                <div className="p-6 overflow-y-auto max-h-[calc(85vh-140px)]">
                  <div className="prose prose-slate dark:prose-invert max-w-none">
                    <h4 className="text-sm font-bold text-gray-400 uppercase tracking-wider mb-2">Deskripsi</h4>
                    <p className="text-gray-700 dark:text-gray-300 mb-6 text-lg">{item.desc || item.description}</p>
                    
                    {item.example && (
                        <>
                            <h4 className="text-sm font-bold text-gray-400 uppercase tracking-wider mb-2">Contoh Penggunaan</h4>
                            <div className="p-4 bg-slate-50 dark:bg-slate-900/50 rounded-xl border border-slate-100 dark:border-slate-800 text-slate-700 dark:text-slate-300">
                                {formatExample(item.example)}
                            </div>
                        </>
                    )}
                  </div>
                </div>
              </div>
            </div>
          );
        };

        const AiResponseViewer = ({ text }) => {
          const formattedText = text
            .split('\n') 
            .map((line, lineIndex) => {
              if (line.trim() === '') return <br key={lineIndex} />;

              const parts = line.split(/(\*\*.*?\*\*|`.*?`)/g);

              return (
                <p key={lineIndex} className="mb-3 last:mb-0 leading-relaxed text-gray-700 dark:text-gray-300">
                  {parts.map((part, partIndex) => {
                    if (part.startsWith('**') && part.endsWith('**')) {
                      return <strong key={partIndex} className="font-bold text-gray-900 dark:text-white">{part.substring(2, part.length - 2)}</strong>;
                    }
                    if (part.startsWith('`') && part.endsWith('`')) {
                      return <code key={partIndex} className="bg-blue-50 dark:bg-blue-900/30 text-blue-700 dark:text-blue-300 px-1.5 py-0.5 rounded font-mono text-sm">{part.substring(1, part.length - 1)}</code>;
                    }
                    return part;
                  })}
                </p>
              );
            });

          return (
            <div className="text-sm md:text-base">
              {formattedText}
            </div>
          );
        };

        const Sidebar = ({ activeView, setActiveView, isSidebarOpen, toggleSidebar }) => {
          const navItems = [
            { id: 'home', name: 'Beranda', icon: Icons.Learn },
            { id: 'formulas', name: 'Ensiklopedia Rumus', icon: Icons.BookOpen },
            { id: 'shortcuts', name: 'Kumpulan Shortcut', icon: Icons.Keyboard },
            { id: 'exercises', name: 'Latihan Soal', icon: Icons.Download },
            { id: 'ai', name: 'AI Penjelas', icon: Icons.Ai },
            { id: 'bookmarks', name: 'Bookmark Saya', icon: Icons.Bookmark },
          ];

          const NavLink = ({ id, name, icon: Icon }) => (
            <button
              onClick={() => { setActiveView(id); if (isSidebarOpen) toggleSidebar(); }}
              className={`flex items-center w-full px-4 py-3 mb-1 rounded-lg transition-all duration-200 font-medium ${
                activeView === id
                  ? 'bg-gradient-to-r from-blue-600 to-indigo-600 text-white shadow-md'
                  : 'text-gray-600 dark:text-gray-400 hover:bg-gray-100 dark:hover:bg-gray-800 hover:text-blue-600 dark:hover:text-blue-400'
              }`}
            >
              <Icon className={`w-5 h-5 mr-3 ${activeView === id ? 'text-white' : 'text-gray-400 dark:text-gray-500 group-hover:text-blue-500'}`} />
              <span>{name}</span>
            </button>
          );

          return (
            <React.Fragment>
              {isSidebarOpen && <div className="fixed inset-0 bg-gray-900/50 backdrop-blur-sm z-20 lg:hidden" onClick={toggleSidebar}></div>}
              <aside className={`fixed lg:sticky top-0 left-0 z-30 w-72 h-full bg-white dark:bg-gray-900 shadow-xl border-r border-gray-200 dark:border-gray-800 transition-transform duration-300 ease-in-out transform ${isSidebarOpen ? 'translate-x-0' : '-translate-x-full'} lg:translate-x-0 lg:flex lg:flex-col`}>
                <div className="flex items-center justify-between h-20 px-6 border-b border-gray-100 dark:border-gray-800">
                  <div className="flex items-center space-x-2">
                    <div className="w-8 h-8 bg-blue-600 rounded-lg flex items-center justify-center"><span className="text-white font-bold text-lg">E</span></div>
                    <h1 className="text-lg font-bold bg-clip-text text-transparent bg-gradient-to-r from-blue-600 to-indigo-600 dark:from-blue-400 dark:to-indigo-400">Excel Asisten</h1>
                  </div>
                  <button onClick={toggleSidebar} className="lg:hidden p-2 rounded-md text-gray-500 hover:bg-gray-100 dark:text-gray-400 dark:hover:bg-gray-800"><Icons.Close className="w-5 h-5" /></button>
                </div>
                <div className="p-4">
                    <p className="text-xs font-semibold text-gray-400 uppercase tracking-wider mb-3 px-2">Menu Utama</p>
                    <nav className="space-y-1">{navItems.map(item => <NavLink key={item.id} {...item} />)}</nav>
                </div>
                <div className="mt-auto p-6 border-t border-gray-100 dark:border-gray-800">
                   <p className="text-[10px] text-center text-gray-400 dark:text-gray-600 mt-4">&copy; {new Date().getFullYear()} RiyanS Tech</p>
                </div>
              </aside>
            </React.Fragment>
          );
        };

        // --- Views ---
        const HomeView = ({ dailyItems, onSelect, onAskAi }) => (
          <div className="p-6 md:p-8 max-w-7xl mx-auto space-y-8">
            {/* Hero Section */}
            <div className="relative overflow-hidden rounded-2xl bg-gradient-to-br from-blue-600 to-indigo-700 dark:from-blue-900 dark:to-indigo-900 shadow-xl text-white p-8 md:p-10">
                <div className="absolute top-0 right-0 -mt-10 -mr-10 w-64 h-64 bg-white/10 rounded-full blur-3xl"></div>
                <div className="absolute bottom-0 left-0 -mb-10 -ml-10 w-64 h-64 bg-indigo-500/20 rounded-full blur-3xl"></div>
                
                <div className="relative z-10">
                    <h2 className="text-3xl md:text-4xl font-extrabold mb-4">Selamat Datang, Master Excel!</h2>
                    <p className="text-blue-100 text-lg mb-8 max-w-2xl leading-relaxed">
                        Jelajahi 136 rumus dan ratusan shortcut yang akan meningkatkan produktivitasmu. Mulai belajar hari ini atau tanya AI kami.
                    </p>
                    <button 
                        onClick={() => onAskAi("Apa itu XLOOKUP dan kenapa lebih baik dari VLOOKUP?")}
                        className="group bg-white text-blue-700 hover:bg-blue-50 font-bold py-3 px-6 rounded-xl shadow-lg transition-all transform hover:-translate-y-1 flex items-center gap-2"
                    >
                        <Icons.Ai className="w-5 h-5 text-blue-600" />
                        <span>Tanya AI (Contoh: XLOOKUP vs VLOOKUP)</span>
                        <Icons.ArrowUp className="w-4 h-4 rotate-90 group-hover:translate-x-1 transition-transform" />
                    </button>
                </div>
            </div>
            
            {/* Daily Learn Section */}
            <div className="grid grid-cols-1 lg:grid-cols-2 gap-8">
                <div className="bg-white dark:bg-gray-800 rounded-2xl p-6 shadow-sm border border-gray-100 dark:border-gray-700">
                    <div className="flex items-center gap-3 mb-6">
                        <div className="p-2 bg-green-100 dark:bg-green-900/30 rounded-lg text-green-600 dark:text-green-400">
                            <Icons.BookOpen className="w-6 h-6" />
                        </div>
                        <h3 className="text-xl font-bold text-gray-900 dark:text-white">Rumus Hari Ini</h3>
                    </div>
                    <div className="space-y-3">
                        {dailyItems.formulas.map((item, idx) => (
                        <div key={item.id} onClick={() => onSelect(item)} 
                             className="group flex items-center p-4 rounded-xl bg-gray-50 dark:bg-gray-700/50 hover:bg-white dark:hover:bg-gray-700 border border-transparent hover:border-green-200 dark:hover:border-green-900 hover:shadow-md transition-all cursor-pointer">
                            <span className="flex-shrink-0 w-8 h-8 flex items-center justify-center bg-green-100 dark:bg-green-900 text-green-700 dark:text-green-300 font-bold rounded-lg text-sm mr-4 group-hover:scale-110 transition-transform">{idx + 1}</span>
                            <div>
                                <h5 className="font-bold text-gray-800 dark:text-white group-hover:text-green-700 dark:group-hover:text-green-400 transition-colors">{item.name}</h5>
                                <p className="text-sm text-gray-500 dark:text-gray-400 line-clamp-1">{item.description}</p>
                            </div>
                        </div>
                        ))}
                    </div>
                </div>

                <div className="bg-white dark:bg-gray-800 rounded-2xl p-6 shadow-sm border border-gray-100 dark:border-gray-700">
                    <div className="flex items-center gap-3 mb-6">
                        <div className="p-2 bg-orange-100 dark:bg-orange-900/30 rounded-lg text-orange-600 dark:text-orange-400">
                            <Icons.Keyboard className="w-6 h-6" />
                        </div>
                        <h3 className="text-xl font-bold text-gray-900 dark:text-white">Shortcut Hari Ini</h3>
                    </div>
                    <div className="space-y-3">
                        {dailyItems.shortcuts.map((item, idx) => (
                        <div key={item.id} onClick={() => onSelect(item)} 
                             className="group flex items-center justify-between p-4 rounded-xl bg-gray-50 dark:bg-gray-700/50 hover:bg-white dark:hover:bg-gray-700 border border-transparent hover:border-orange-200 dark:hover:border-orange-900 hover:shadow-md transition-all cursor-pointer">
                            <div className="flex items-center overflow-hidden">
                                <span className="flex-shrink-0 w-8 h-8 flex items-center justify-center bg-orange-100 dark:bg-orange-900 text-orange-700 dark:text-orange-300 font-bold rounded-lg text-sm mr-4 group-hover:scale-110 transition-transform">{idx + 1}</span>
                                <h5 className="font-bold text-gray-800 dark:text-white truncate group-hover:text-orange-700 dark:group-hover:text-orange-400 transition-colors">{item.desc}</h5>
                            </div>
                            <kbd className="ml-4 px-2 py-1 text-xs font-bold font-sans text-gray-600 bg-white dark:text-gray-300 dark:bg-gray-800 rounded border-b-2 border-gray-200 dark:border-gray-600 flex-shrink-0">{item.combo}</kbd>
                        </div>
                        ))}
                    </div>
                </div>
            </div>
          </div>
        );

        const FormulaView = ({ onSelect, bookmarks, onBookmark }) => {
          const [searchTerm, setSearchTerm] = useState('');
          const [categories, setCategories] = useState([]);
          const [selectedCategory, setSelectedCategory] = useState('Semua');

          useEffect(() => {
            const allCats = [...new Set(formulaData.map(f => f.category))].sort();
            setCategories(['Semua', ...allCats]);
          }, []);

          const filteredFormulas = useMemo(() => {
            return formulaData
              .filter(f => selectedCategory === 'Semua' || f.category === selectedCategory)
              .filter(f => 
                f.name.toLowerCase().includes(searchTerm.toLowerCase()) ||
                f.description.toLowerCase().includes(searchTerm.toLowerCase())
              );
          }, [searchTerm, selectedCategory]);

          return (
            <div className="flex flex-col h-full bg-gray-50 dark:bg-gray-900">
              <div className="bg-white dark:bg-gray-900 p-6 shadow-sm border-b border-gray-200 dark:border-gray-800 sticky top-0 z-10">
                <div className="max-w-7xl mx-auto">
                    <div className="relative mb-6">
                    <input
                        type="text"
                        value={searchTerm}
                        onChange={e => setSearchTerm(e.target.value)}
                        placeholder={`Cari ${filteredFormulas.length} dari ${formulaData.length} rumus (cth: "VLOOKUP")...`}
                        className="w-full pl-12 pr-4 py-3.5 rounded-xl border border-gray-200 dark:border-gray-700 bg-gray-50 dark:bg-gray-800 text-gray-900 dark:text-white focus:outline-none focus:ring-2 focus:ring-blue-500 focus:bg-white dark:focus:bg-gray-800 transition-all shadow-sm"
                    />
                    <Icons.Search className="w-5 h-5 absolute left-4 top-1/2 -translate-y-1/2 text-gray-400" />
                    </div>
                    
                    <div className="flex flex-wrap gap-2 justify-center">
                    {categories.map(cat => (
                        <button
                        key={cat}
                        onClick={() => setSelectedCategory(cat)}
                        className={getCategoryButtonClass(cat, selectedCategory === cat)}
                        >
                        {cat}
                        </button>
                    ))}
                    </div>
                </div>
              </div>
              
              <div className="flex-1 overflow-y-auto p-6">
                <div className="max-w-7xl mx-auto grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6 pb-20">
                  {filteredFormulas.length > 0 ? (
                    filteredFormulas.map(formula => (
                      <ItemCard
                        key={formula.id}
                        item={formula}
                        isBookmarked={bookmarks.includes(formula.id)}
                        onBookmark={onBookmark}
                        onClick={onSelect}
                      />
                    ))
                  ) : (
                    <div className="md:col-span-2 lg:col-span-3 text-center py-20">
                        <div className="w-20 h-20 bg-gray-100 dark:bg-gray-800 rounded-full flex items-center justify-center mx-auto mb-4">
                            <Icons.Search className="w-8 h-8 text-gray-400" />
                        </div>
                        <h3 className="text-lg font-medium text-gray-900 dark:text-white">Tidak ada rumus yang ditemukan</h3>
                        <p className="text-gray-500 dark:text-gray-400">Coba kata kunci lain atau ganti kategori filter.</p>
                    </div>
                  )}
                </div>
              </div>
            </div>
          );
        };

        const ShortcutView = ({ onSelect, bookmarks, onBookmark }) => {
          const [searchTerm, setSearchTerm] = useState('');
          const [categories, setCategories] = useState([]);
          const [selectedCategory, setSelectedCategory] = useState('Semua');

          useEffect(() => {
            const allCats = [...new Set(shortcutData.map(s => s.category))].sort();
            setCategories(['Semua', ...allCats]);
          }, []);

          const filteredShortcuts = useMemo(() => {
            return shortcutData
              .filter(s => selectedCategory === 'Semua' || s.category === selectedCategory)
              .filter(s => 
                s.desc.toLowerCase().includes(searchTerm.toLowerCase()) ||
                s.combo.toLowerCase().includes(searchTerm.toLowerCase())
              );
          }, [searchTerm, selectedCategory]);

          return (
            <div className="flex flex-col h-full bg-gray-50 dark:bg-gray-900">
              <div className="bg-white dark:bg-gray-900 p-6 shadow-sm border-b border-gray-200 dark:border-gray-800 sticky top-0 z-10">
                <div className="max-w-7xl mx-auto">
                    <div className="relative mb-6">
                    <input
                        type="text"
                        value={searchTerm}
                        onChange={e => setSearchTerm(e.target.value)}
                        placeholder={`Cari ${filteredShortcuts.length} dari ${shortcutData.length} shortcut (cth: "copy")...`}
                        className="w-full pl-12 pr-4 py-3.5 rounded-xl border border-gray-200 dark:border-gray-700 bg-gray-50 dark:bg-gray-800 text-gray-900 dark:text-white focus:outline-none focus:ring-2 focus:ring-blue-500 focus:bg-white dark:focus:bg-gray-800 transition-all shadow-sm"
                    />
                    <Icons.Search className="w-5 h-5 absolute left-4 top-1/2 -translate-y-1/2 text-gray-400" />
                    </div>
                    
                    <div className="flex flex-wrap gap-2 justify-center">
                    {categories.map(cat => (
                        <button
                        key={cat}
                        onClick={() => setSelectedCategory(cat)}
                        className={getCategoryButtonClass(cat, selectedCategory === cat)}
                        >
                        {cat}
                        </button>
                    ))}
                    </div>
                </div>
              </div>
              
              <div className="flex-1 overflow-y-auto p-6">
                <div className="max-w-7xl mx-auto grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6 pb-20">
                  {filteredShortcuts.length > 0 ? (
                    filteredShortcuts.map(shortcut => (
                      <ItemCard
                        key={shortcut.id}
                        item={shortcut}
                        isBookmarked={bookmarks.includes(shortcut.id)}
                        onBookmark={onBookmark}
                        onClick={onSelect}
                      />
                    ))
                  ) : (
                    <div className="md:col-span-2 lg:col-span-3 text-center py-20">
                        <div className="w-20 h-20 bg-gray-100 dark:bg-gray-800 rounded-full flex items-center justify-center mx-auto mb-4">
                            <Icons.Search className="w-8 h-8 text-gray-400" />
                        </div>
                        <h3 className="text-lg font-medium text-gray-900 dark:text-white">Tidak ada shortcut yang ditemukan</h3>
                        <p className="text-gray-500 dark:text-gray-400">Coba kata kunci lain atau ganti kategori filter.</p>
                    </div>
                  )}
                </div>
              </div>
            </div>
          );
        };

        const BookmarkView = ({ items, onSelect, bookmarks, onBookmark }) => (
          <div className="p-6 md:p-8 h-full overflow-y-auto">
            {items.length === 0 ? (
              <div className="flex flex-col items-center justify-center h-[60vh] text-center">
                <div className="w-24 h-24 bg-yellow-50 dark:bg-yellow-900/20 rounded-full flex items-center justify-center mb-6">
                    <Icons.Bookmark className="w-10 h-10 text-yellow-500" />
                </div>
                <h3 className="text-2xl font-bold text-gray-900 dark:text-white mb-2">Belum Ada Bookmark</h3>
                <p className="text-gray-500 dark:text-gray-400 max-w-md">
                    Klik ikon bookmark pada rumus atau shortcut yang sering kamu gunakan untuk menyimpannya di sini agar mudah diakses.
                </p>
              </div>
            ) : (
              <div className="max-w-7xl mx-auto">
                  <h2 className="text-2xl font-bold text-gray-900 dark:text-white mb-6 pl-1 border-l-4 border-yellow-500">Item Tersimpan ({items.length})</h2>
                  <div className="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6 pb-20">
                    {items.map(item => (
                    <ItemCard
                        key={item.id}
                        item={item}
                        isBookmarked={bookmarks.includes(item.id)}
                        onBookmark={onBookmark}
                        onClick={onSelect}
                    />
                    ))}
                  </div>
              </div>
            )}
          </div>
        );

        const AiView = ({ aiHook }) => {
          const { getExplanation, aiResponse, isLoading, error } = aiHook;
          const [query, setQuery] = useState('');
          
          const handleSubmit = (e) => {
            e.preventDefault();
            if (query.trim() && !isLoading) {
              getExplanation(query);
            }
          };
          
          const handleSuggestionClick = (suggestion) => {
            setQuery(suggestion);
            getExplanation(suggestion);
          };

          const suggestions = [
            "Jelaskan rumus SUMIFS",
            "Apa beda COUNT, COUNTA, dan COUNTIF?",
            "Bagaimana cara kerja INDEX MATCH?",
            "Shortcut untuk format mata uang",
          ];

          return (
            <div className="h-full flex flex-col bg-gray-50 dark:bg-gray-900 relative">
              <div className="flex-1 overflow-y-auto p-6 md:p-8 pb-32">
                <div className="max-w-3xl mx-auto">
                    {/* Area Respons AI */}
                    <div className="bg-white dark:bg-gray-800 rounded-2xl shadow-lg border border-gray-200 dark:border-gray-700 overflow-hidden min-h-[400px] flex flex-col">
                    {isLoading ? (
                        <div className="flex flex-col items-center justify-center flex-1 p-12">
                            <div className="relative w-16 h-16 mb-4">
                                <div className="absolute inset-0 border-4 border-blue-100 dark:border-blue-900 rounded-full"></div>
                                <div className="absolute inset-0 border-4 border-blue-600 rounded-full border-t-transparent animate-spin"></div>
                                <Icons.Ai className="absolute inset-0 m-auto w-6 h-6 text-blue-600 animate-pulse" />
                            </div>
                            <span className="text-lg font-medium text-gray-600 dark:text-gray-300 animate-pulse">AI sedang berpikir...</span>
                        </div>
                    ) : error ? (
                        <div className="flex flex-col items-center justify-center flex-1 p-12 text-center">
                            <div className="w-16 h-16 bg-red-100 dark:bg-red-900/30 rounded-full flex items-center justify-center mb-4">
                                <span className="text-2xl"></span>
                            </div>
                            <p className="text-red-600 dark:text-red-400 font-medium">{error}</p>
                        </div>
                    ) : !aiResponse ? (
                        <div className="flex flex-col items-center justify-center flex-1 p-12 text-center">
                            <div className="w-20 h-20 bg-blue-50 dark:bg-blue-900/20 rounded-full flex items-center justify-center mb-6">
                                <Icons.Ai className="w-10 h-10 text-blue-600 dark:text-blue-400" />
                            </div>
                            <h3 className="text-2xl font-bold text-gray-900 dark:text-white mb-2">Tanya AI Penjelas</h3>
                            <p className="text-gray-500 dark:text-gray-400 mb-8 max-w-md">
                                Bingung soal rumus atau butuh cara cepat? Tanyakan apa saja, saya siap membantu.
                            </p>
                            <div className="flex flex-wrap justify-center gap-3">
                                {suggestions.map(s => (
                                <button
                                    key={s}
                                    onClick={() => handleSuggestionClick(s)}
                                    className="px-4 py-2 bg-gray-100 dark:bg-gray-700 text-sm text-gray-700 dark:text-gray-200 rounded-full hover:bg-blue-100 dark:hover:bg-blue-900 hover:text-blue-700 dark:hover:text-blue-300 transition-colors"
                                >
                                    {s}
                                </button>
                                ))}
                            </div>
                        </div>
                    ) : (
                        <div className="p-8">
                            <div className="flex items-center gap-3 mb-6 pb-4 border-b border-gray-100 dark:border-gray-700">
                                <div className="p-2 bg-blue-100 dark:bg-blue-900/30 rounded-lg">
                                    <Icons.Ai className="w-6 h-6 text-blue-600 dark:text-blue-400" />
                                </div>
                                <h3 className="font-bold text-gray-900 dark:text-white">Jawaban AI</h3>
                            </div>
                            <AiResponseViewer text={aiResponse} />
                        </div>
                    )}
                    </div>
                </div>
              </div>
              
              {/* Form Input Pertanyaan */}
              <div className="absolute bottom-0 left-0 right-0 bg-white/90 dark:bg-gray-900/90 backdrop-blur-md border-t border-gray-200 dark:border-gray-800 p-4 md:p-6 z-20">
                <div className="max-w-3xl mx-auto">
                    <form onSubmit={handleSubmit} className="relative flex items-center shadow-lg rounded-2xl overflow-hidden border border-gray-200 dark:border-gray-700">
                    <input
                        type="text"
                        value={query}
                        onChange={e => setQuery(e.target.value)}
                        disabled={isLoading}
                        placeholder="Ketik pertanyaan Anda tentang Excel di sini..."
                        className="flex-1 px-6 py-4 bg-white dark:bg-gray-800 text-gray-900 dark:text-white focus:outline-none disabled:opacity-50 disabled:cursor-not-allowed"
                    />
                    <button
                        type="submit"
                        disabled={isLoading || !query.trim()}
                        className="px-8 py-4 bg-blue-600 text-white font-bold hover:bg-blue-700 transition-colors disabled:bg-gray-300 dark:disabled:bg-gray-700 disabled:cursor-not-allowed"
                    >
                        {isLoading ? (
                            <span className="animate-pulse">...</span>
                        ) : (
                            <div className="flex items-center gap-2">
                                <span>Kirim</span>
                                <Icons.ArrowUp className="w-4 h-4 rotate-90" />
                            </div>
                        )}
                    </button>
                    </form>
                </div>
              </div>
            </div>
          );
        };

        const ExercisesView = ({ exercises, addExercise, deleteExercise }) => {
            const [showForm, setShowForm] = useState(false);
            const [newTitle, setNewTitle] = useState('');
            const [newDesc, setNewDesc] = useState('');
            const [newUrl, setNewUrl] = useState('');

            const handleSubmit = (e) => {
                e.preventDefault();
                if (newTitle && newUrl) {
                    addExercise(newTitle, newDesc, newUrl);
                    setNewTitle('');
                    setNewDesc('');
                    setNewUrl('');
                    setShowForm(false);
                }
            };

            return (
                <div className="p-6 md:p-8 h-full overflow-y-auto bg-gray-50 dark:bg-gray-900">
                    <div className="max-w-5xl mx-auto">
                        <div className="flex flex-col md:flex-row justify-between items-start md:items-center mb-8 gap-4">
                            <div>
                                <h2 className="text-2xl font-bold text-gray-900 dark:text-white">Latihan Soal & Template</h2>
                                <p className="text-gray-500 dark:text-gray-400 mt-1">Download file latihan untuk mengasah skill Excel-mu.</p>
                            </div>
                            <button 
                                onClick={() => setShowForm(!showForm)}
                                className="flex items-center gap-2 px-4 py-2 bg-blue-600 hover:bg-blue-700 text-white rounded-lg font-medium transition-colors shadow-md"
                            >
                                <Icons.Plus className="w-5 h-5" />
                                <span>Tambah Link</span>
                            </button>
                        </div>

                        {showForm && (
                            <div className="mb-8 p-6 bg-white dark:bg-gray-800 rounded-2xl shadow-lg border border-blue-100 dark:border-blue-900/30 animate-in slide-in-from-top-4 duration-300">
                                <h3 className="text-lg font-bold text-gray-800 dark:text-white mb-4">Bagikan File Latihan</h3>
                                <form onSubmit={handleSubmit} className="space-y-4">
                                    <div>
                                        <label className="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1">Judul Latihan</label>
                                        <input type="text" value={newTitle} onChange={e => setNewTitle(e.target.value)} required className="w-full px-4 py-2 rounded-lg border border-gray-300 dark:border-gray-600 bg-gray-50 dark:bg-gray-700 text-gray-900 dark:text-white focus:ring-2 focus:ring-blue-500 focus:outline-none" placeholder="Contoh: Latihan VLOOKUP Dasar" />
                                    </div>
                                    <div>
                                        <label className="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1">Deskripsi (Opsional)</label>
                                        <textarea value={newDesc} onChange={e => setNewDesc(e.target.value)} className="w-full px-4 py-2 rounded-lg border border-gray-300 dark:border-gray-600 bg-gray-50 dark:bg-gray-700 text-gray-900 dark:text-white focus:ring-2 focus:ring-blue-500 focus:outline-none" placeholder="Deskripsi singkat tentang isi file..." rows="2"></textarea>
                                    </div>
                                    <div>
                                        <label className="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1">Link Google Drive / Download</label>
                                        <input type="url" value={newUrl} onChange={e => setNewUrl(e.target.value)} required className="w-full px-4 py-2 rounded-lg border border-gray-300 dark:border-gray-600 bg-gray-50 dark:bg-gray-700 text-gray-900 dark:text-white focus:ring-2 focus:ring-blue-500 focus:outline-none" placeholder="https://..." />
                                    </div>
                                    <div className="flex justify-end gap-3 pt-2">
                                        <button type="button" onClick={() => setShowForm(false)} className="px-4 py-2 text-gray-600 dark:text-gray-300 hover:bg-gray-100 dark:hover:bg-gray-700 rounded-lg font-medium transition-colors">Batal</button>
                                        <button type="submit" className="px-6 py-2 bg-blue-600 hover:bg-blue-700 text-white rounded-lg font-medium transition-colors shadow-md">Simpan</button>
                                    </div>
                                </form>
                            </div>
                        )}

                        <div className="grid grid-cols-1 md:grid-cols-2 gap-6">
                            {exercises.map((ex) => (
                                <div key={ex.id} className="group relative bg-white dark:bg-gray-800 rounded-2xl p-6 shadow-sm hover:shadow-xl transition-all border border-gray-100 dark:border-gray-700 flex flex-col">
                                    <div className="flex items-start justify-between mb-4">
                                        <div className="p-3 bg-green-100 dark:bg-green-900/30 rounded-xl text-green-600 dark:text-green-400">
                                            <svg className="w-8 h-8" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                                                <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={1.5} d="M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z" />
                                            </svg>
                                        </div>
                                        <button 
                                            onClick={() => deleteExercise(ex.id)}
                                            className="p-2 text-gray-400 hover:text-red-500 hover:bg-red-50 dark:hover:bg-red-900/20 rounded-lg transition-colors opacity-0 group-hover:opacity-100"
                                            title="Hapus Link"
                                        >
                                            <Icons.Trash className="w-5 h-5" />
                                        </button>
                                    </div>
                                    
                                    <h3 className="text-lg font-bold text-gray-900 dark:text-white mb-2">{ex.title}</h3>
                                    <p className="text-sm text-gray-600 dark:text-gray-400 mb-6 flex-grow">{ex.description || "Tidak ada deskripsi."}</p>
                                    
                                    <div className="flex items-center justify-between mt-auto pt-4 border-t border-gray-100 dark:border-gray-700">
                                        <span className="text-xs text-gray-400">{ex.date}</span>
                                        <a 
                                            href={ex.url} 
                                            target="_blank" 
                                            rel="noopener noreferrer"
                                            className="flex items-center gap-2 px-4 py-2 bg-green-600 hover:bg-green-700 text-white text-sm font-bold rounded-lg transition-colors shadow-md"
                                        >
                                            <Icons.Download className="w-4 h-4" />
                                            Download
                                        </a>
                                    </div>
                                </div>
                            ))}
                        </div>

                        {exercises.length === 0 && (
                            <div className="text-center py-20 text-gray-500 dark:text-gray-400">
                                <div className="w-16 h-16 bg-gray-100 dark:bg-gray-800 rounded-full flex items-center justify-center mx-auto mb-4">
                                    <Icons.Download className="w-8 h-8 text-gray-400" />
                                </div>
                                <p>Belum ada file latihan yang ditambahkan.</p>
                            </div>
                        )}
                    </div>
                </div>
            );
        };

        // --- App Component Integration ---
        const App = () => {
          const [activeView, setActiveView] = useState('home'); 
          const [isSidebarOpen, setIsSidebarOpen] = useState(false);
          const [selectedItem, setSelectedItem] = useState(null);
          const [isModalOpen, setIsModalOpen] = useState(false);

          const [isDarkMode, toggleDarkMode] = useDarkMode();
          const aiHook = useAiHelper();
          const { exercises, addExercise, deleteExercise } = useExercises();

          const allData = useMemo(() => [...formulaData, ...shortcutData], []);
          const { bookmarkedIds, toggleBookmark, bookmarkedItems } = useBookmarks(allData);
          const dailyItems = useDailyLearn(formulaData, shortcutData);
          
          const toggleSidebar = () => setIsSidebarOpen(prev => !prev);
          const handleSelectitem = useCallback((item) => { setSelectedItem(item); setIsModalOpen(true); }, []);
          const closeModal = useCallback(() => { setIsModalOpen(false); setTimeout(() => setSelectedItem(null), 300); }, []);
          const handleAskAi = useCallback((query) => { setActiveView('ai'); aiHook.getExplanation(query); }, [aiHook]);

          const renderView = () => {
            switch (activeView) {
              case 'home': return <div className="h-full overflow-y-auto"><HomeView dailyItems={dailyItems} onSelect={handleSelectitem} onAskAi={handleAskAi} /></div>;
              case 'formulas': return <FormulaView onSelect={handleSelectitem} bookmarks={bookmarkedIds} onBookmark={toggleBookmark} />;
              case 'shortcuts': return <ShortcutView onSelect={handleSelectitem} bookmarks={bookmarkedIds} onBookmark={toggleBookmark} />;
              case 'ai': return <AiView aiHook={aiHook} />;
              case 'bookmarks': return <BookmarkView items={bookmarkedItems} onSelect={handleSelectitem} bookmarks={bookmarkedIds} onBookmark={toggleBookmark} />;
              case 'exercises': return <ExercisesView exercises={exercises} addExercise={addExercise} deleteExercise={deleteExercise} />;
              default: return <div className="h-full overflow-y-auto"><HomeView dailyItems={dailyItems} onSelect={handleSelectitem} onAskAi={handleAskAi} /></div>;
            }
          };

          return (
            <div className="flex h-screen bg-gray-50 dark:bg-gray-900 font-inter overflow-hidden">
              <Sidebar activeView={activeView} setActiveView={setActiveView} isSidebarOpen={isSidebarOpen} toggleSidebar={toggleSidebar} />
              <div className="flex-1 flex flex-col w-full lg:w-[calc(100%-18rem)] h-full relative">
                <Header toggleSidebar={toggleSidebar} toggleDarkMode={toggleDarkMode} isDarkMode={isDarkMode} activeViewName={activeView === 'exercises' ? 'Latihan Soal' : (activeView.charAt(0).toUpperCase() + activeView.slice(1))} />
                <main className="flex-1 relative overflow-hidden">{renderView()}</main>
              </div>
              <DetailModal item={selectedItem} isOpen={isModalOpen} onClose={closeModal} isBookmarked={selectedItem ? bookmarkedIds.includes(selectedItem.id) : false} onBookmark={toggleBookmark} />
            </div>
          );
        };

        const root = ReactDOM.createRoot(document.getElementById('root'));
        root.render(<App />);
    </script>
</body>

</html>



